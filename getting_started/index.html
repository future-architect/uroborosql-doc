<!DOCTYPE html>
<html lang="ja">

<!-- Head tag -->
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--Description-->
    
        <meta name="description" content="uroboroSQLの公式ドキュメントサイトです。">
    

    <!--Author-->
    
        <meta name="author" content="Future Architect">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Getting Started">
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="uroboroSQL ドキュメント">

    <!--Page Cover-->
    
        <meta property="og:image" content="/uroborosql-doc/images/logo.png">
    

    <!-- Title -->
    
    <title>Getting Started - uroboroSQL ドキュメント</title>

    <!-- Custom CSS -->
    <!-- <link rel="stylesheet" href="/css/main.css"> -->
    <link rel="stylesheet" href="/uroborosql-doc/css/main.css">

    <!--[if lt IE 8]>
        <script src="/uroborosql-doc/js/ie/html5shiv.js"></script>
    <![endif]-->

    <!--[if lt IE 8]>
        <link rel="stylesheet" href="/uroborosql-doc/sass/ie8.css">
    <![endif]-->

    <!--[if lt IE 9]>
        <link rel="stylesheet" href="/uroborosql-doc/sass/ie9.css">
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.css" type="text/css" rel="stylesheet">
    <link rel="shortcut icon" href="/uroborosql-doc/favicon.ico">

    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <script src="https://apis.google.com/js/platform.js" async defer>
      {lang: 'ja'}
    </script>
    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-93486523-1', 'auto');
        ga('send', 'pageview');

    </script>



</head>


<body>

    <div id="wrapper">

        <!-- Menu -->
        <!-- Header -->
<header id="header">
    <div class="inner">
        <!-- Logo -->
        <a href="/uroborosql-doc/" class="logo">
            <span class="symbol"><img src="/uroborosql-doc//images/logo.png" alt=""></span>
        </a>
        <!-- Nav -->
        <nav>
            <ul>
                <li><a href="#menu">Menu</a></li>
            </ul>
        </nav>
    </div>
</header>
<!-- Menu -->
<nav id="menu">
    <h2>Menu</h2>
    <form id="search-form">
        <input type="text" id="local-search-input" name="q" results="0" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off">
        <i class="fa fa-times" onclick="resetSearch()"></i>
    </form>
    <div id="local-search-result"></div>
    <p class="no-result">No results found</p>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
    <script src="/uroborosql-doc/js/search.js"></script>
    <script>
    var path = "/uroborosql-doc//search.xml";
    searchFunc(path, 'local-search-input', 'local-search-result');
    </script>
    <ul id="menu-agenda">
        <li><a href="/uroborosql-doc/why_uroborosql/">Why uroboroSQL?</a></li>
        <li><a href="/uroborosql-doc/getting_started/">Getting Started</a></li>
        <li><a href="/uroborosql-doc/basics/">基本操作</a></li>
        <li><a href="/uroborosql-doc/advanced/">高度な操作</a></li>
        <li><a href="/uroborosql-doc/developer_guide/">開発者ガイド</a></li>
        <li><a href="/uroborosql-doc/license/">License</a></li>
        <li><a href="/uroborosql-doc/about_uroborosql/">uroboroSQLについて</a></li>
    </ul>
</nav>

        <div id="main">
            <div class="inner">

                <!-- Main Content -->
                

    <h1>Getting Started</h1>



<!-- Gallery -->


<!-- Content -->
<hr>
<ul>
<li><a href="#環境設定">環境設定</a><ul>
<li><a href="#ビルドツールの設定">ビルドツールの設定</a></li>
<li><a href="#事前準備">事前準備</a></li>
</ul>
</li>
<li><a href="#サンプルプロジェクトの実行">サンプルプロジェクトの実行</a></li>
<li><a href="#サンプルプロジェクトの構成">サンプルプロジェクトの構成</a></li>
<li><a href="#SQLの実行方法">SQLの実行方法</a></li>
<li><a href="#SQL-REPL">SQL-REPL</a></li>
</ul>
<hr>
<h2 id="環境設定"><a href="#環境設定" class="headerlink" title="環境設定"></a>環境設定</h2><h3 id="ビルドツールの設定"><a href="#ビルドツールの設定" class="headerlink" title="ビルドツールの設定"></a>ビルドツールの設定</h3><p>uroboroSQLをMavenプロジェクトに組み込むには、<strong>pom.xml</strong>に以下の記述を加えて下さい。<br>uroboroSQLは<a href="https://search.maven.org/#search%7Cga%7C1%7Curoborosql" target="_blank" rel="noopener">Maven Central Repository</a>で公開されています。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jp.co.future<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>uroborosql<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.6.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Gradleプロジェクトの場合は、<strong>build.gradle</strong>のdependencies内に以下の記述を加えて下さい。</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">compile</span> <span class="keyword">group</span>: <span class="string">'jp.co.future'</span>, name: <span class="string">'uroborosql'</span>, version: <span class="string">'0.6.1'</span></span><br></pre></td></tr></table></figure>
<h2 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h2><p>事前準備として、</p>
<ul>
<li><a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">JDK8</a></li>
<li><a href="https://maven.apache.org/download.cgi" target="_blank" rel="noopener">Apache Maven</a></li>
</ul>
<p>をインストールしてください。</p>
<h2 id="サンプルプロジェクトの実行"><a href="#サンプルプロジェクトの実行" class="headerlink" title="サンプルプロジェクトの実行"></a>サンプルプロジェクトの実行</h2><p>uroboroSQLのサンプルアプリケーションであるuroborosql-sampleを使ってuroboroSQLを動かしてみましょう。</p>
<p>まず始めに<a href="https://github.com/future-architect/uroborosql-sample" target="_blank" rel="noopener">uroborosql-sample</a>から最新のソースコードを取得します。<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/future-architect/uroborosql-sample.git</span><br></pre></td></tr></table></figure></p>
<p>取得できたらcloneしたフォルダに移動します。<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> uroborosql-sample</span><br></pre></td></tr></table></figure></p>
<p>まずはサンプルアプリケーションを実行してみましょう。<br>サンプルアプリケーションは以下の起動コマンドで実行します。<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -PrunMain</span><br></pre></td></tr></table></figure></p>
<p>これでサンプルアプリケーションが実行されます。（初回実行時は必要なライブラリをダウンロードするため時間がかかります）<br>アプリケーションの実行ログが出力され、Mavenが正常終了すれば成功です。<br>色々ログが流れますが、この中でDB接続からテーブル作成、データの挿入、検索、バッチ更新、トランザクション、といった一連の処理が実行されています。</p>
<p>Main.java<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> jp.co.future.uroborosql.sample;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.UncheckedIOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.time.LocalDate;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.IntStream;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Stream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jp.co.future.uroborosql.SqlAgent;</span><br><span class="line"><span class="keyword">import</span> jp.co.future.uroborosql.SqlAgentFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> jp.co.future.uroborosql.UroboroSQL;</span><br><span class="line"><span class="keyword">import</span> jp.co.future.uroborosql.config.SqlConfig;</span><br><span class="line"><span class="keyword">import</span> jp.co.future.uroborosql.context.SqlContextFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> jp.co.future.uroborosql.sample.entity.Department;</span><br><span class="line"><span class="keyword">import</span> jp.co.future.uroborosql.sample.entity.Employee;</span><br><span class="line"><span class="keyword">import</span> jp.co.future.uroborosql.sample.type.Gender;</span><br><span class="line"><span class="keyword">import</span> jp.co.future.uroborosql.utils.CaseFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * uroboroSQL Sample Application</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> H.Sugimoto</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">  <span class="comment">/** ロガー */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(Main.class);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">final</span> String... args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// create SqlConfig</span></span><br><span class="line">    SqlConfig config = UroboroSQL</span><br><span class="line">        .builder(<span class="string">"jdbc:h2:mem:test;DB_CLOSE_DELAY=-1"</span>, <span class="string">"sa"</span>, <span class="string">""</span>)</span><br><span class="line">        <span class="comment">// SqlContextFactoryの設定（Enum定数パッケージ設定の追加）</span></span><br><span class="line">        .setSqlContextFactory(</span><br><span class="line">            <span class="keyword">new</span> SqlContextFactoryImpl().setEnumConstantPackageNames(Arrays.asList(Gender.class.getPackage()</span><br><span class="line">                .getName())))</span><br><span class="line">        <span class="comment">// SqlAgentFactoryの設定（Queryの戻り値のMapのキー文字列のデフォルトCaseFormat設定の追加）</span></span><br><span class="line">        .setSqlAgentFactory(<span class="keyword">new</span> SqlAgentFactoryImpl().setDefaultMapKeyCaseFormat(CaseFormat.CAMEL_CASE))</span><br><span class="line">        .build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// create SqlAgent. SqlAgent implements AutoClosable.</span></span><br><span class="line">    <span class="keyword">try</span> (SqlAgent agent = config.agent()) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// create table :  テーブル作成</span></span><br><span class="line">      <span class="keyword">int</span> createCount = agent.update(<span class="string">"ddl/create_tables"</span>).count();</span><br><span class="line">      log(<span class="string">"ddl/create_tables count=&#123;&#125;"</span>, createCount);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// setup data : 初期データ挿入</span></span><br><span class="line">      <span class="keyword">int</span> setupCount = agent.update(<span class="string">"setup/insert_data"</span>).count();</span><br><span class="line">      log(<span class="string">"setup/insert_data count=&#123;&#125;"</span>, setupCount);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// select department data (collect) : 部署データ検索（collect API）</span></span><br><span class="line">      log(<span class="string">"select department data (collect)"</span>);</span><br><span class="line">      <span class="comment">// no parameter : バインドパラメータ指定なしで検索</span></span><br><span class="line">      List&lt;Map&lt;String, Object&gt;&gt; departments = agent.query(<span class="string">"department/select_department"</span>).collect();</span><br><span class="line">      departments.forEach(data -&gt; log(toS(data)));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// add bind parameter : バインドパラメータを設定して検索</span></span><br><span class="line">      log(<span class="string">"select department data (collect) set param(dept_no=1001)"</span>);</span><br><span class="line">      departments = agent.query(<span class="string">"department/select_department"</span>).param(<span class="string">"dept_no"</span>, <span class="number">1001</span>).collect();</span><br><span class="line">      departments.forEach(data -&gt; log(toS(data)));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// with Entity : エンティティによる部署データ検索</span></span><br><span class="line">      log(<span class="string">"select department data with Entity (collect)"</span>);</span><br><span class="line">      <span class="comment">// no parameter : 条件指定なしで検索</span></span><br><span class="line">      List&lt;Department&gt; departmentEntities = agent.query(Department.class).collect();</span><br><span class="line">      departmentEntities.forEach(data -&gt; log(toS(data)));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// add bind parameter : 条件を設定して検索</span></span><br><span class="line">      log(<span class="string">"select department data with Entity (collect) set param(deptNo=1001)"</span>);</span><br><span class="line">      departmentEntities = agent.query(Department.class).param(<span class="string">"deptNo"</span><span class="comment">/* camelCase */</span>, <span class="number">1001</span>).collect();</span><br><span class="line">      departmentEntities.forEach(data -&gt; log(toS(data)));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// find department by dept_no key : キー（dept_no）を指定して、部署データ１件取得（find API）</span></span><br><span class="line">      log(<span class="string">"select department data by key (find)"</span>);</span><br><span class="line">      Department department = agent.find(Department.class, <span class="number">1002</span>).orElse(<span class="keyword">null</span>);</span><br><span class="line">      log(toS(department));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// find first : findFirstを使用した先頭1件検索</span></span><br><span class="line">      log(<span class="string">"select first employee data.(Optional)"</span>);</span><br><span class="line">      agent.query(<span class="string">"employee/select_employee"</span>).findFirst().ifPresent(m -&gt; log(toS(m)));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// select employee data (stream) : 従業員データ検索（stream API）</span></span><br><span class="line">      log(<span class="string">"select employee data (stream)"</span>);</span><br><span class="line">      <span class="comment">// no parameter : バインドパラメータ指定なしで検索（BEGIN-ENDで囲まれた範囲内のIF条件がすべてfalseのため、BEGIN-ENDの中が削除される）</span></span><br><span class="line">      agent.query(<span class="string">"employee/select_employee"</span>).stream().forEachOrdered(m -&gt; log(toS(m)));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// add bind date parameter : バインドパラメータ（日付型）を指定して検索</span></span><br><span class="line">      agent.query(<span class="string">"employee/select_employee"</span>).param(<span class="string">"birth_date_from"</span>, LocalDate.of(<span class="number">1990</span>, <span class="number">1</span>, <span class="number">1</span>)).stream()</span><br><span class="line">          .forEachOrdered(m -&gt; log(toS(m)));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// add bind list parameter : バインドパラメータ（IN句用）を指定して検索</span></span><br><span class="line">      agent.query(<span class="string">"employee/select_employee"</span>).paramList(<span class="string">"gender_list"</span>, Gender.FEMALE).stream()</span><br><span class="line">          .forEachOrdered(m -&gt; log(toS(m)));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// use sql enum constant : SQL上でEnum定数を使用した検索</span></span><br><span class="line">      agent.query(<span class="string">"employee/select_employee"</span>).param(<span class="string">"female"</span>, <span class="keyword">true</span>).stream().forEachOrdered(m -&gt; log(toS(m)));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// with Entity : エンティティによる従業員データ検索（stream API）</span></span><br><span class="line">      log(<span class="string">"select employee data with Entity (stream)"</span>);</span><br><span class="line">      <span class="comment">// no parameter : バインドパラメータ指定なしで検索</span></span><br><span class="line">      agent.query(Employee.class).stream().forEachOrdered(m -&gt; log(toS(m)));</span><br><span class="line">      <span class="comment">// use LocalDate parameter : LocalDateを使用した検索</span></span><br><span class="line">      agent.query(Employee.class).param(<span class="string">"birthDate"</span>, LocalDate.of(<span class="number">1970</span>, <span class="number">1</span>, <span class="number">2</span>)).stream()</span><br><span class="line">          .forEachOrdered(m -&gt; log(toS(m)));</span><br><span class="line">      <span class="comment">// use enum parameter : Enumを使用した検索</span></span><br><span class="line">      agent.query(Employee.class).param(<span class="string">"gender"</span>, Gender.FEMALE).stream().forEachOrdered(m -&gt; log(toS(m)));</span><br><span class="line"></span><br><span class="line">      log(<span class="string">"delete tables with sql literal"</span>);</span><br><span class="line">      <span class="comment">// update with sql literal</span></span><br><span class="line">      log(<span class="string">"delete dept_emp count=&#123;&#125;"</span>, agent.updateWith(<span class="string">"delete from dept_emp"</span>).count());</span><br><span class="line">      log(<span class="string">"delete department count=&#123;&#125;"</span>, agent.updateWith(<span class="string">"delete from department"</span>).count());</span><br><span class="line">      log(<span class="string">"delete employee count=&#123;&#125;"</span>, agent.updateWith(<span class="string">"delete from employee"</span>).count());</span><br><span class="line"></span><br><span class="line">      log(<span class="string">"commit!"</span>);</span><br><span class="line">      agent.commit();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// transaction (requiredNew)</span></span><br><span class="line">      agent.requiresNew(() -&gt; &#123;</span><br><span class="line"></span><br><span class="line">        log(<span class="string">"create new transaction."</span>);</span><br><span class="line">        <span class="comment">// batch insert (new v0.5.0)</span></span><br><span class="line">        log(<span class="string">"department/insert_department batch insert."</span>);</span><br><span class="line">        <span class="comment">// department</span></span><br><span class="line">        <span class="keyword">int</span> deptCount = agent.batch(<span class="string">"department/insert_department"</span>)</span><br><span class="line">            .paramStream(getDataByFile(Paths.get(<span class="string">"src/main/resources/data/department.tsv"</span>))).count();</span><br><span class="line">        log(<span class="string">"department/insert_department count=&#123;&#125;"</span>, deptCount);</span><br><span class="line"></span><br><span class="line">        log(<span class="string">"employee/insert_employee batch insert."</span>);</span><br><span class="line">        <span class="comment">// employee</span></span><br><span class="line">        <span class="comment">// execute by 2 rows</span></span><br><span class="line">        <span class="keyword">int</span> empCount = agent.batch(<span class="string">"employee/insert_employee"</span>)</span><br><span class="line">            .paramStream(getDataByFile(Paths.get(<span class="string">"src/main/resources/data/employee.tsv"</span>)))</span><br><span class="line">            .by((ctx, row) -&gt; ctx.batchCount() == <span class="number">2</span>).count();</span><br><span class="line">        log(<span class="string">"employee/insert_employee count=&#123;&#125;"</span>, empCount);</span><br><span class="line"></span><br><span class="line">        log(<span class="string">"relation/insert_dept_emp batch insert."</span>);</span><br><span class="line">        <span class="comment">// dept_emp</span></span><br><span class="line">        <span class="comment">// log message when batch execute.</span></span><br><span class="line">        <span class="keyword">int</span> deptEmpCount = agent.batch(<span class="string">"relation/insert_dept_emp"</span>)</span><br><span class="line">            .paramStream(getDataByFile(Paths.get(<span class="string">"src/main/resources/data/dept_emp.tsv"</span>)))</span><br><span class="line">            .batchWhen((agt, ctx) -&gt; log(<span class="string">"batch execute."</span>)).count();</span><br><span class="line">        log(<span class="string">"relation/insert_dept_emp count=&#123;&#125;"</span>, deptEmpCount);</span><br><span class="line"></span><br><span class="line">        log(<span class="string">"employee/select_employee in transaction select"</span>);</span><br><span class="line">        agent.query(<span class="string">"employee/select_employee"</span>).stream().forEachOrdered(m -&gt; log(toS(m)));</span><br><span class="line"></span><br><span class="line">        log(<span class="string">"transaction rollback!"</span>);</span><br><span class="line">        agent.setRollbackOnly();</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      agent.requiresNew(() -&gt; &#123;</span><br><span class="line">        <span class="comment">// insert with Entity</span></span><br><span class="line">        log(<span class="string">"insert with Entity"</span>);</span><br><span class="line">        Department informationDept = <span class="keyword">new</span> Department();</span><br><span class="line">        informationDept.setDeptNo(<span class="number">1005</span>);</span><br><span class="line">        informationDept.setDeptName(<span class="string">"information"</span>);</span><br><span class="line">        agent.insert(informationDept);</span><br><span class="line"></span><br><span class="line">        log(toS(agent.find(Department.class, <span class="number">1005</span>).get()));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// update with Entity</span></span><br><span class="line">        log(<span class="string">"update with Entity"</span>);</span><br><span class="line">        informationDept.setDeptName(<span class="string">"Information System"</span>);</span><br><span class="line">        agent.update(informationDept);</span><br><span class="line"></span><br><span class="line">        log(toS(agent.find(Department.class, <span class="number">1005</span>).get()));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// delete with Entity</span></span><br><span class="line">        log(<span class="string">"delete with Entity"</span>);</span><br><span class="line">        agent.delete(informationDept);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!agent.find(Department.class, <span class="number">1005</span>).isPresent()) &#123;</span><br><span class="line">          log(<span class="string">"deptNo = 1005 deleted!!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        log(<span class="string">"transaction rollback!"</span>);</span><br><span class="line">        agent.setRollbackOnly();</span><br><span class="line">      &#125;);</span><br><span class="line">      log(<span class="string">"employee/select_employee after transaction select. employee is empty."</span>);</span><br><span class="line">      agent.query(<span class="string">"employee/select_employee"</span>).stream().forEachOrdered(m -&gt; log(toS(m)));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Read TSV file data and convert to List Object.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> filePath TSV file path.</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> Data List</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Stream&lt;Map&lt;String, Object&gt;&gt; getDataByFile(<span class="keyword">final</span> Path filePath) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      List&lt;String&gt; lines = Files.readAllLines(filePath);</span><br><span class="line">      String[] header = lines.get(<span class="number">0</span>).split(<span class="string">"\\t"</span>);</span><br><span class="line">      <span class="keyword">return</span> lines.stream()</span><br><span class="line">          .skip(<span class="number">1</span>)</span><br><span class="line">          .map(s -&gt; s.split(<span class="string">"\\t"</span>))</span><br><span class="line">          .map(data -&gt; IntStream.range(<span class="number">0</span>, header.length)</span><br><span class="line">              .&lt;Map&lt;String, Object&gt;&gt; collect(HashMap::<span class="keyword">new</span>, (row, i) -&gt; row.put(header[i], data[i]),</span><br><span class="line">                  Map::putAll));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> UncheckedIOException(e);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">toS</span><span class="params">(<span class="keyword">final</span> Object obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> Map) &#123;</span><br><span class="line">      Map&lt;String, Object&gt; map = (Map&lt;String, Object&gt;) obj;</span><br><span class="line">      <span class="keyword">return</span> map.entrySet().stream()</span><br><span class="line">          .map(e -&gt; e.getKey() + <span class="string">"="</span> + e.getValue())</span><br><span class="line">          .collect(Collectors.joining(<span class="string">","</span>, <span class="string">"&#123;"</span>, <span class="string">"&#125;"</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> obj.toString();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(<span class="keyword">final</span> String format, <span class="keyword">final</span> Object... arguments)</span> </span>&#123;</span><br><span class="line">    log.info(format, arguments);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>実行ログ<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br></pre></td><td class="code"><pre><span class="line">[DEBUG] <span class="built_in">Start</span> loading SQL template.[C:\git\uroborosql-sample\target\classes\sql]</span><br><span class="line">[DEBUG] Loading SQL template.[]</span><br><span class="line">[DEBUG] Loading SQL template.[ddl]</span><br><span class="line">[DEBUG] Loading SQL template.[department]</span><br><span class="line">[DEBUG] Loading SQL template.[employee]</span><br><span class="line">[DEBUG] Loading SQL template.[relation]</span><br><span class="line">[DEBUG] Loading SQL template.[setup]</span><br><span class="line">[DEBUG] Enum [name：CLS_GENDER_MALE, value：M] added to parameter.</span><br><span class="line">[DEBUG] Enum [name：CLS_GENDER_FEMALE, value：F] added to parameter.</span><br><span class="line">[DEBUG] Enum [name：CLS_GENDER_OTHER, value：O] added to parameter.</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">-- employee</span><br><span class="line">drop table <span class="keyword">if</span> exists employee cascade;</span><br><span class="line">create table employee (</span><br><span class="line">  emp_no NUMBER(<span class="number">11</span>) <span class="keyword">not</span> null</span><br><span class="line">  , first_name VARCHAR(<span class="number">20</span>) <span class="keyword">not</span> null</span><br><span class="line">  , last_name VARCHAR(<span class="number">20</span>) <span class="keyword">not</span> null</span><br><span class="line">  , birth_date <span class="built_in">DATE</span> <span class="keyword">not</span> null</span><br><span class="line">  , gender CHAR(<span class="number">1</span>) <span class="keyword">not</span> null</span><br><span class="line">  , lock_version NUMBER(<span class="number">10</span>) <span class="keyword">not</span> null default <span class="number">0</span></span><br><span class="line">  , constraint employee_PKC primary key (emp_no)</span><br><span class="line">) ;</span><br><span class="line">-- dept_emp</span><br><span class="line">drop table <span class="keyword">if</span> exists dept_emp cascade;</span><br><span class="line">create table dept_emp (</span><br><span class="line">  emp_no NUMBER(<span class="number">11</span>) <span class="keyword">not</span> null</span><br><span class="line">  , dept_no NUMBER(<span class="number">4</span>) <span class="keyword">not</span> null</span><br><span class="line">  , constraint dept_emp_PKC primary key (emp_no,dept_no)</span><br><span class="line">) ;</span><br><span class="line">-- department</span><br><span class="line">drop table <span class="keyword">if</span> exists department cascade;</span><br><span class="line">create table department (</span><br><span class="line">  dept_no NUMBER(<span class="number">4</span>) <span class="keyword">not</span> null</span><br><span class="line">  , dept_name VARCHAR(<span class="number">100</span>) <span class="keyword">not</span> null</span><br><span class="line">  , lock_version NUMBER(<span class="number">10</span>) <span class="keyword">not</span> null default <span class="number">0</span></span><br><span class="line">  , constraint department_PKC primary key (dept_no)</span><br><span class="line">) ;</span><br><span class="line">comment on table employee is 'employee';</span><br><span class="line">comment on column employee.emp_no is 'emp_no';</span><br><span class="line">comment on column employee.first_name is 'first_name';</span><br><span class="line">comment on column employee.last_name is 'last_name';</span><br><span class="line">comment on column employee.birth_date is 'birth_date';</span><br><span class="line">comment on column employee.gender is 'gender   ''F''emale/''M''ale/''O''ther';</span><br><span class="line">comment on column employee.lock_version is 'lock_version';</span><br><span class="line">comment on table dept_emp is 'dept_emp';</span><br><span class="line">comment on column dept_emp.emp_no is 'emp_no';</span><br><span class="line">comment on column dept_emp.dept_no is 'dept_no';</span><br><span class="line">comment on table department is 'department';</span><br><span class="line">comment on column department.dept_no is 'dept_no';</span><br><span class="line">comment on column department.dept_name is 'dept_name';</span><br><span class="line">comment on column department.lock_version is 'lock_version'</span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute update SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [ddl/create_tables] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">018</span>]</span><br><span class="line">[INFO ] ddl/create_tables count=<span class="number">0</span></span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">insert into department (dept_no, dept_name) values (<span class="number">1001</span>, 'sales');</span><br><span class="line">insert into department (dept_no, dept_name) values (<span class="number">1002</span>, 'export');</span><br><span class="line">insert into department (dept_no, dept_name) values (<span class="number">1003</span>, 'accounting');</span><br><span class="line">insert into department (dept_no, dept_name) values (<span class="number">1004</span>, 'personnel');</span><br><span class="line">insert into employee (emp_no, first_name, last_name, birth_date, gender) values (<span class="number">0001</span>, 'Bob', 'Smith', '<span class="number">1970</span>-<span class="number">01</span>-<span class="number">02</span>', 'M');</span><br><span class="line">insert into employee (emp_no, first_name, last_name, birth_date, gender) values (<span class="number">0002</span>, 'Susan', 'Davis', '<span class="number">1969</span>-<span class="number">02</span>-<span class="number">10</span>', 'F');</span><br><span class="line">insert into employee (emp_no, first_name, last_name, birth_date, gender) values (<span class="number">0003</span>, 'John', 'Wilson', '<span class="number">1982</span>-<span class="number">05</span>-<span class="number">08</span>', 'M');</span><br><span class="line">insert into employee (emp_no, first_name, last_name, birth_date, gender) values (<span class="number">0004</span>, 'Sharon', 'Johnson', '<span class="number">1990</span>-<span class="number">01</span>-<span class="number">20</span>', 'F');</span><br><span class="line">insert into employee (emp_no, first_name, last_name, birth_date, gender) values (<span class="number">0005</span>, 'Stephen', 'Taylor', '<span class="number">2003</span>-<span class="number">12</span>-<span class="number">31</span>', 'M');</span><br><span class="line">insert into dept_emp (emp_no, dept_no) values (<span class="number">0001</span>, '<span class="number">1001</span>');</span><br><span class="line">insert into dept_emp (emp_no, dept_no) values (<span class="number">0002</span>, '<span class="number">1001</span>');</span><br><span class="line">insert into dept_emp (emp_no, dept_no) values (<span class="number">0003</span>, '<span class="number">1002</span>');</span><br><span class="line">insert into dept_emp (emp_no, dept_no) values (<span class="number">0004</span>, '<span class="number">1003</span>');</span><br><span class="line">insert into dept_emp (emp_no, dept_no) values (<span class="number">0005</span>, '<span class="number">1004</span>')</span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute update SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [setup/insert_data] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">007</span>]</span><br><span class="line">[INFO ] setup/insert_data count=<span class="number">1</span></span><br><span class="line">[INFO ] select department data (collect)</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(dept_no)], Result：[false], Parameter：[dept_no:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(dept_name)], Result：[false], Parameter：[dept_name:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* department/select_department */</span><br><span class="line">  DEPT.DEPT_NO    AS  DEPT_NO</span><br><span class="line">, DEPT.DEPT_NAME    AS  DEPT_NAME</span><br><span class="line">, DEPT.LOCK_VERSION AS  LOCK_VERSION</span><br><span class="line">FROM</span><br><span class="line">  DEPARTMENT  DEPT</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [department/select_department] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">005</span>]</span><br><span class="line">[INFO ] &#123;deptNo=<span class="number">1001</span>,deptName=sales,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;deptNo=<span class="number">1002</span>,deptName=export,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;deptNo=<span class="number">1003</span>,deptName=accounting,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;deptNo=<span class="number">1004</span>,deptName=personnel,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] select department data (collect) <span class="built_in">set</span> param(dept_no=<span class="number">1001</span>)</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(dept_no)], Result：[true], Parameter：[dept_no:[<span class="number">1001</span>]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(dept_name)], Result：[false], Parameter：[dept_name:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* department/select_department */</span><br><span class="line">  DEPT.DEPT_NO    AS  DEPT_NO</span><br><span class="line">, DEPT.DEPT_NAME    AS  DEPT_NAME</span><br><span class="line">, DEPT.LOCK_VERSION AS  LOCK_VERSION</span><br><span class="line">FROM</span><br><span class="line">  DEPARTMENT  DEPT</span><br><span class="line">WHERE</span><br><span class="line">DEPT.DEPT_NO  = ?/*dept_no*/</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[dept_no], Value[<span class="number">1001</span>], Class[Integer]]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [department/select_department] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] &#123;deptNo=<span class="number">1001</span>,deptName=sales,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] select department data with Entity (collect)</span><br><span class="line">[DEBUG] Evaluation Expression：[deptNo != null], Result：[false], Parameter：[deptNo:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(deptName)], Result：[false], Parameter：[deptName:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[lockVersion != null], Result：[false], Parameter：[lockVersion:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* mapping @ Department */</span><br><span class="line">   DEPT_NO  AS  DEPT_NO -- dept_no</span><br><span class="line">  , DEPT_NAME AS  DEPT_NAME -- dept_name</span><br><span class="line">  , LOCK_VERSION  AS  LOCK_VERSION  -- lock_version</span><br><span class="line">FROM PUBLIC.DEPARTMENT</span><br><span class="line">ORDER BY </span><br><span class="line">   DEPT_NO</span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] Department [deptNo=<span class="number">1001</span>, deptName=sales, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] Department [deptNo=<span class="number">1002</span>, deptName=export, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] Department [deptNo=<span class="number">1003</span>, deptName=accounting, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] Department [deptNo=<span class="number">1004</span>, deptName=personnel, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] select department data with Entity (collect) <span class="built_in">set</span> param(deptNo=<span class="number">1001</span>)</span><br><span class="line">[DEBUG] Evaluation Expression：[deptNo != null], Result：[true], Parameter：[deptNo:[<span class="number">1001</span>]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(deptName)], Result：[false], Parameter：[deptName:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[lockVersion != null], Result：[false], Parameter：[lockVersion:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* mapping @ Department */</span><br><span class="line">   DEPT_NO  AS  DEPT_NO -- dept_no</span><br><span class="line">  , DEPT_NAME AS  DEPT_NAME -- dept_name</span><br><span class="line">  , LOCK_VERSION  AS  LOCK_VERSION  -- lock_version</span><br><span class="line">FROM PUBLIC.DEPARTMENT</span><br><span class="line">WHERE</span><br><span class="line">  DEPT_NO = ?/*deptNo*/</span><br><span class="line">ORDER BY </span><br><span class="line">   DEPT_NO</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[deptNo], Value[<span class="number">1001</span>], Class[Integer]]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] Department [deptNo=<span class="number">1001</span>, deptName=sales, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] select department data by key (<span class="built_in">find</span>)</span><br><span class="line">[DEBUG] Evaluation Expression：[deptNo != null], Result：[true], Parameter：[deptNo:[<span class="number">1002</span>]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(deptName)], Result：[false], Parameter：[deptName:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[lockVersion != null], Result：[false], Parameter：[lockVersion:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* mapping @ Department */</span><br><span class="line">   DEPT_NO  AS  DEPT_NO -- dept_no</span><br><span class="line">  , DEPT_NAME AS  DEPT_NAME -- dept_name</span><br><span class="line">  , LOCK_VERSION  AS  LOCK_VERSION  -- lock_version</span><br><span class="line">FROM PUBLIC.DEPARTMENT</span><br><span class="line">WHERE</span><br><span class="line">  DEPT_NO = ?/*deptNo*/</span><br><span class="line">ORDER BY </span><br><span class="line">   DEPT_NO</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[deptNo], Value[<span class="number">1002</span>], Class[Integer]]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] Department [deptNo=<span class="number">1002</span>, deptName=export, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] select first employee data.(Optional)</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(emp_no)], Result：[false], Parameter：[emp_no:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(first_name)], Result：[false], Parameter：[first_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(last_name)], Result：[false], Parameter：[last_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_from)], Result：[false], Parameter：[birth_date_from:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_to)], Result：[false], Parameter：[birth_date_to:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[gender_list != null], Result：[false], Parameter：[gender_list:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[female != null and female], Result：[false], Parameter：[female:[null],female:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* employee/select_employee */</span><br><span class="line">  EMP.EMP_NO      AS  EMP_NO</span><br><span class="line">, EMP.FIRST_NAME    AS  FIRST_NAME</span><br><span class="line">, EMP.LAST_NAME   AS  LAST_NAME</span><br><span class="line">, EMP.BIRTH_DATE    AS  BIRTH_DATE</span><br><span class="line">, EMP.GENDER      AS  GENDER</span><br><span class="line">, EMP.LOCK_VERSION  AS  LOCK_VERSION</span><br><span class="line">FROM</span><br><span class="line">  EMPLOYEE  EMP</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [employee/select_employee] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">1</span>,firstName=Bob,lastName=Smith,birthDate=<span class="number">1970</span>-<span class="number">01</span>-<span class="number">02</span>,gender=M,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] select employee data (stream)</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(emp_no)], Result：[false], Parameter：[emp_no:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(first_name)], Result：[false], Parameter：[first_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(last_name)], Result：[false], Parameter：[last_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_from)], Result：[false], Parameter：[birth_date_from:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_to)], Result：[false], Parameter：[birth_date_to:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[gender_list != null], Result：[false], Parameter：[gender_list:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[female != null and female], Result：[false], Parameter：[female:[null],female:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* employee/select_employee */</span><br><span class="line">  EMP.EMP_NO      AS  EMP_NO</span><br><span class="line">, EMP.FIRST_NAME    AS  FIRST_NAME</span><br><span class="line">, EMP.LAST_NAME   AS  LAST_NAME</span><br><span class="line">, EMP.BIRTH_DATE    AS  BIRTH_DATE</span><br><span class="line">, EMP.GENDER      AS  GENDER</span><br><span class="line">, EMP.LOCK_VERSION  AS  LOCK_VERSION</span><br><span class="line">FROM</span><br><span class="line">  EMPLOYEE  EMP</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [employee/select_employee] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">1</span>,firstName=Bob,lastName=Smith,birthDate=<span class="number">1970</span>-<span class="number">01</span>-<span class="number">02</span>,gender=M,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">2</span>,firstName=Susan,lastName=Davis,birthDate=<span class="number">1969</span>-<span class="number">02</span>-<span class="number">10</span>,gender=F,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">3</span>,firstName=John,lastName=Wilson,birthDate=<span class="number">1982</span>-<span class="number">05</span>-<span class="number">08</span>,gender=M,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">4</span>,firstName=Sharon,lastName=Johnson,birthDate=<span class="number">1990</span>-<span class="number">01</span>-<span class="number">20</span>,gender=F,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">5</span>,firstName=Stephen,lastName=Taylor,birthDate=<span class="number">2003</span>-<span class="number">12</span>-<span class="number">31</span>,gender=M,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(emp_no)], Result：[false], Parameter：[emp_no:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(first_name)], Result：[false], Parameter：[first_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(last_name)], Result：[false], Parameter：[last_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_from)], Result：[true], Parameter：[birth_date_from:[<span class="number">1990</span>,<span class="number">1</span>,<span class="number">1</span>]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_to)], Result：[false], Parameter：[birth_date_to:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[gender_list != null], Result：[false], Parameter：[gender_list:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[female != null and female], Result：[false], Parameter：[female:[null],female:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* employee/select_employee */</span><br><span class="line">  EMP.EMP_NO      AS  EMP_NO</span><br><span class="line">, EMP.FIRST_NAME    AS  FIRST_NAME</span><br><span class="line">, EMP.LAST_NAME   AS  LAST_NAME</span><br><span class="line">, EMP.BIRTH_DATE    AS  BIRTH_DATE</span><br><span class="line">, EMP.GENDER      AS  GENDER</span><br><span class="line">, EMP.LOCK_VERSION  AS  LOCK_VERSION</span><br><span class="line">FROM</span><br><span class="line">  EMPLOYEE  EMP</span><br><span class="line">WHERE</span><br><span class="line">EMP.BIRTH_DATE  &gt;=  ?/*birth_date_from*/</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[birth_date_from], Value[<span class="number">1990</span>-<span class="number">01</span>-<span class="number">01</span>], Class[LocalDate]]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [employee/select_employee] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">4</span>,firstName=Sharon,lastName=Johnson,birthDate=<span class="number">1990</span>-<span class="number">01</span>-<span class="number">20</span>,gender=F,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">5</span>,firstName=Stephen,lastName=Taylor,birthDate=<span class="number">2003</span>-<span class="number">12</span>-<span class="number">31</span>,gender=M,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(emp_no)], Result：[false], Parameter：[emp_no:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(first_name)], Result：[false], Parameter：[first_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(last_name)], Result：[false], Parameter：[last_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_from)], Result：[false], Parameter：[birth_date_from:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_to)], Result：[false], Parameter：[birth_date_to:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[gender_list != null], Result：[true], Parameter：[gender_list:[&#123;F&#125;]]</span><br><span class="line">[DEBUG] Evaluation Expression：[female != null and female], Result：[false], Parameter：[female:[null],female:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* employee/select_employee */</span><br><span class="line">  EMP.EMP_NO      AS  EMP_NO</span><br><span class="line">, EMP.FIRST_NAME    AS  FIRST_NAME</span><br><span class="line">, EMP.LAST_NAME   AS  LAST_NAME</span><br><span class="line">, EMP.BIRTH_DATE    AS  BIRTH_DATE</span><br><span class="line">, EMP.GENDER      AS  GENDER</span><br><span class="line">, EMP.LOCK_VERSION  AS  LOCK_VERSION</span><br><span class="line">FROM</span><br><span class="line">  EMPLOYEE  EMP</span><br><span class="line">WHERE</span><br><span class="line">EMP.GENDER    IN  (?)/*gender_list*/</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[gender_list], Value[[Ljava.lang.Object;@<span class="number">69</span>e9510a], Class[Object[]]]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [employee/select_employee] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">2</span>,firstName=Susan,lastName=Davis,birthDate=<span class="number">1969</span>-<span class="number">02</span>-<span class="number">10</span>,gender=F,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">4</span>,firstName=Sharon,lastName=Johnson,birthDate=<span class="number">1990</span>-<span class="number">01</span>-<span class="number">20</span>,gender=F,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(emp_no)], Result：[false], Parameter：[emp_no:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(first_name)], Result：[false], Parameter：[first_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(last_name)], Result：[false], Parameter：[last_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_from)], Result：[false], Parameter：[birth_date_from:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_to)], Result：[false], Parameter：[birth_date_to:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[gender_list != null], Result：[false], Parameter：[gender_list:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[female != null and female], Result：[true], Parameter：[female:[true],female:[true]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* employee/select_employee */</span><br><span class="line">  EMP.EMP_NO      AS  EMP_NO</span><br><span class="line">, EMP.FIRST_NAME    AS  FIRST_NAME</span><br><span class="line">, EMP.LAST_NAME   AS  LAST_NAME</span><br><span class="line">, EMP.BIRTH_DATE    AS  BIRTH_DATE</span><br><span class="line">, EMP.GENDER      AS  GENDER</span><br><span class="line">, EMP.LOCK_VERSION  AS  LOCK_VERSION</span><br><span class="line">FROM</span><br><span class="line">  EMPLOYEE  EMP</span><br><span class="line">WHERE</span><br><span class="line">EMP.GENDER    = 'F'/*#CLS_GENDER_FEMALE*/</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [employee/select_employee] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">2</span>,firstName=Susan,lastName=Davis,birthDate=<span class="number">1969</span>-<span class="number">02</span>-<span class="number">10</span>,gender=F,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">4</span>,firstName=Sharon,lastName=Johnson,birthDate=<span class="number">1990</span>-<span class="number">01</span>-<span class="number">20</span>,gender=F,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] select employee data with Entity (stream)</span><br><span class="line">[DEBUG] Evaluation Expression：[empNo != null], Result：[false], Parameter：[empNo:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(firstName)], Result：[false], Parameter：[firstName:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(lastName)], Result：[false], Parameter：[lastName:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[birthDate != null], Result：[false], Parameter：[birthDate:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(gender)], Result：[false], Parameter：[gender:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[lockVersion != null], Result：[false], Parameter：[lockVersion:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* mapping @ Employee */</span><br><span class="line">   EMP_NO AS  EMP_NO  -- emp_no</span><br><span class="line">  , FIRST_NAME  AS  FIRST_NAME  -- first_name</span><br><span class="line">  , LAST_NAME AS  LAST_NAME -- last_name</span><br><span class="line">  , BIRTH_DATE  AS  BIRTH_DATE  -- birth_date</span><br><span class="line">  , GENDER  AS  GENDER  -- gender  'F'emale/'M'ale/'O'ther</span><br><span class="line">  , LOCK_VERSION  AS  LOCK_VERSION  -- lock_version</span><br><span class="line">FROM PUBLIC.EMPLOYEE</span><br><span class="line">ORDER BY </span><br><span class="line">   EMP_NO</span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] Employee [empNo=<span class="number">1</span>, firstName=Bob, lastName=Smith, birthDate=<span class="number">1970</span>-<span class="number">01</span>-<span class="number">02</span>, gender=M, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] Employee [empNo=<span class="number">2</span>, firstName=Susan, lastName=Davis, birthDate=<span class="number">1969</span>-<span class="number">02</span>-<span class="number">10</span>, gender=F, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] Employee [empNo=<span class="number">3</span>, firstName=John, lastName=Wilson, birthDate=<span class="number">1982</span>-<span class="number">05</span>-<span class="number">08</span>, gender=M, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] Employee [empNo=<span class="number">4</span>, firstName=Sharon, lastName=Johnson, birthDate=<span class="number">1990</span>-<span class="number">01</span>-<span class="number">20</span>, gender=F, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] Employee [empNo=<span class="number">5</span>, firstName=Stephen, lastName=Taylor, birthDate=<span class="number">2003</span>-<span class="number">12</span>-<span class="number">31</span>, gender=M, lockVersion=<span class="number">0</span>]</span><br><span class="line">[DEBUG] Evaluation Expression：[empNo != null], Result：[false], Parameter：[empNo:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(firstName)], Result：[false], Parameter：[firstName:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(lastName)], Result：[false], Parameter：[lastName:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[birthDate != null], Result：[true], Parameter：[birthDate:[<span class="number">1970</span>,<span class="number">1</span>,<span class="number">2</span>]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(gender)], Result：[false], Parameter：[gender:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[lockVersion != null], Result：[false], Parameter：[lockVersion:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* mapping @ Employee */</span><br><span class="line">   EMP_NO AS  EMP_NO  -- emp_no</span><br><span class="line">  , FIRST_NAME  AS  FIRST_NAME  -- first_name</span><br><span class="line">  , LAST_NAME AS  LAST_NAME -- last_name</span><br><span class="line">  , BIRTH_DATE  AS  BIRTH_DATE  -- birth_date</span><br><span class="line">  , GENDER  AS  GENDER  -- gender  'F'emale/'M'ale/'O'ther</span><br><span class="line">  , LOCK_VERSION  AS  LOCK_VERSION  -- lock_version</span><br><span class="line">FROM PUBLIC.EMPLOYEE</span><br><span class="line">WHERE</span><br><span class="line">  BIRTH_DATE = ?/*birthDate*/</span><br><span class="line">ORDER BY </span><br><span class="line">   EMP_NO</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[birthDate], Value[<span class="number">1970</span>-<span class="number">01</span>-<span class="number">02</span>], Class[LocalDate]]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] Employee [empNo=<span class="number">1</span>, firstName=Bob, lastName=Smith, birthDate=<span class="number">1970</span>-<span class="number">01</span>-<span class="number">02</span>, gender=M, lockVersion=<span class="number">0</span>]</span><br><span class="line">[DEBUG] Evaluation Expression：[empNo != null], Result：[false], Parameter：[empNo:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(firstName)], Result：[false], Parameter：[firstName:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(lastName)], Result：[false], Parameter：[lastName:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[birthDate != null], Result：[false], Parameter：[birthDate:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(gender)], Result：[true], Parameter：[gender:[F,FEMALE,<span class="number">1</span>]]</span><br><span class="line">[DEBUG] Evaluation Expression：[lockVersion != null], Result：[false], Parameter：[lockVersion:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* mapping @ Employee */</span><br><span class="line">   EMP_NO AS  EMP_NO  -- emp_no</span><br><span class="line">  , FIRST_NAME  AS  FIRST_NAME  -- first_name</span><br><span class="line">  , LAST_NAME AS  LAST_NAME -- last_name</span><br><span class="line">  , BIRTH_DATE  AS  BIRTH_DATE  -- birth_date</span><br><span class="line">  , GENDER  AS  GENDER  -- gender  'F'emale/'M'ale/'O'ther</span><br><span class="line">  , LOCK_VERSION  AS  LOCK_VERSION  -- lock_version</span><br><span class="line">FROM PUBLIC.EMPLOYEE</span><br><span class="line">WHERE</span><br><span class="line">  GENDER = ?/*gender*/</span><br><span class="line">ORDER BY </span><br><span class="line">   EMP_NO</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[gender], Value[F], Class[Gender]]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] Employee [empNo=<span class="number">2</span>, firstName=Susan, lastName=Davis, birthDate=<span class="number">1969</span>-<span class="number">02</span>-<span class="number">10</span>, gender=F, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] Employee [empNo=<span class="number">4</span>, firstName=Sharon, lastName=Johnson, birthDate=<span class="number">1990</span>-<span class="number">01</span>-<span class="number">20</span>, gender=F, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] delete tables with sql literal</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">delete from dept_emp</span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute update SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] delete dept_emp count=<span class="number">5</span></span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">delete from department</span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute update SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] delete department count=<span class="number">4</span></span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">delete from employee</span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute update SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] delete employee count=<span class="number">5</span></span><br><span class="line">[INFO ] commit!</span><br><span class="line">[INFO ] create new transaction.</span><br><span class="line">[INFO ] department/insert_department batch insert.</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">INSERT /* department/insert_department */</span><br><span class="line">INTO</span><br><span class="line">  DEPARTMENT</span><br><span class="line">(</span><br><span class="line">  DEPT_NO</span><br><span class="line">, DEPT_NAME</span><br><span class="line">, LOCK_VERSION</span><br><span class="line">) VALUES (</span><br><span class="line">  ?/*dept_no*/</span><br><span class="line">, ?/*dept_name*/</span><br><span class="line">, <span class="number">0</span></span><br><span class="line">)</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="number">4</span> items Added <span class="keyword">for</span> batch process.</span><br><span class="line">[DEBUG] Execute batch process.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [department/insert_department] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">001</span>]</span><br><span class="line">[INFO ] department/insert_department count=<span class="number">4</span></span><br><span class="line">[INFO ] employee/insert_employee batch insert.</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">INSERT /* employee/insert_employee */</span><br><span class="line">INTO</span><br><span class="line">  EMPLOYEE</span><br><span class="line">(</span><br><span class="line">  EMP_NO</span><br><span class="line">, FIRST_NAME</span><br><span class="line">, LAST_NAME</span><br><span class="line">, BIRTH_DATE</span><br><span class="line">, GENDER</span><br><span class="line">, LOCK_VERSION</span><br><span class="line">) VALUES (</span><br><span class="line">  ?/*emp_no*/</span><br><span class="line">, ?/*first_name*/</span><br><span class="line">, ?/*last_name*/</span><br><span class="line">, ?/*birth_date*/</span><br><span class="line">, ?/*gender*/</span><br><span class="line">, <span class="number">0</span></span><br><span class="line">)</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="number">2</span> items Added <span class="keyword">for</span> batch process.</span><br><span class="line">[DEBUG] Execute batch process.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [employee/insert_employee] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">INSERT /* employee/insert_employee */</span><br><span class="line">INTO</span><br><span class="line">  EMPLOYEE</span><br><span class="line">(</span><br><span class="line">  EMP_NO</span><br><span class="line">, FIRST_NAME</span><br><span class="line">, LAST_NAME</span><br><span class="line">, BIRTH_DATE</span><br><span class="line">, GENDER</span><br><span class="line">, LOCK_VERSION</span><br><span class="line">) VALUES (</span><br><span class="line">  ?/*emp_no*/</span><br><span class="line">, ?/*first_name*/</span><br><span class="line">, ?/*last_name*/</span><br><span class="line">, ?/*birth_date*/</span><br><span class="line">, ?/*gender*/</span><br><span class="line">, <span class="number">0</span></span><br><span class="line">)</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="number">2</span> items Added <span class="keyword">for</span> batch process.</span><br><span class="line">[DEBUG] Execute batch process.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [employee/insert_employee] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">INSERT /* employee/insert_employee */</span><br><span class="line">INTO</span><br><span class="line">  EMPLOYEE</span><br><span class="line">(</span><br><span class="line">  EMP_NO</span><br><span class="line">, FIRST_NAME</span><br><span class="line">, LAST_NAME</span><br><span class="line">, BIRTH_DATE</span><br><span class="line">, GENDER</span><br><span class="line">, LOCK_VERSION</span><br><span class="line">) VALUES (</span><br><span class="line">  ?/*emp_no*/</span><br><span class="line">, ?/*first_name*/</span><br><span class="line">, ?/*last_name*/</span><br><span class="line">, ?/*birth_date*/</span><br><span class="line">, ?/*gender*/</span><br><span class="line">, <span class="number">0</span></span><br><span class="line">)</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="number">1</span> items Added <span class="keyword">for</span> batch process.</span><br><span class="line">[DEBUG] Execute batch process.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [employee/insert_employee] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] employee/insert_employee count=<span class="number">5</span></span><br><span class="line">[INFO ] relation/insert_dept_emp batch insert.</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">INSERT /* relation/insert_dept_emp */</span><br><span class="line">INTO</span><br><span class="line">  DEPT_EMP</span><br><span class="line">(</span><br><span class="line">  EMP_NO</span><br><span class="line">, DEPT_NO</span><br><span class="line">) VALUES (</span><br><span class="line">  ?/*emp_no*/</span><br><span class="line">, ?/*dept_no*/</span><br><span class="line">)</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="number">5</span> items Added <span class="keyword">for</span> batch process.</span><br><span class="line">[DEBUG] Execute batch process.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [relation/insert_dept_emp] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] batch execute.</span><br><span class="line">[INFO ] relation/insert_dept_emp count=<span class="number">5</span></span><br><span class="line">[INFO ] employee/select_employee <span class="keyword">in</span> transaction select</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(emp_no)], Result：[false], Parameter：[emp_no:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(first_name)], Result：[false], Parameter：[first_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(last_name)], Result：[false], Parameter：[last_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_from)], Result：[false], Parameter：[birth_date_from:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_to)], Result：[false], Parameter：[birth_date_to:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[gender_list != null], Result：[false], Parameter：[gender_list:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[female != null and female], Result：[false], Parameter：[female:[null],female:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* employee/select_employee */</span><br><span class="line">  EMP.EMP_NO      AS  EMP_NO</span><br><span class="line">, EMP.FIRST_NAME    AS  FIRST_NAME</span><br><span class="line">, EMP.LAST_NAME   AS  LAST_NAME</span><br><span class="line">, EMP.BIRTH_DATE    AS  BIRTH_DATE</span><br><span class="line">, EMP.GENDER      AS  GENDER</span><br><span class="line">, EMP.LOCK_VERSION  AS  LOCK_VERSION</span><br><span class="line">FROM</span><br><span class="line">  EMPLOYEE  EMP</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [employee/select_employee] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">1</span>,firstName=Bob,lastName=Smith,birthDate=<span class="number">1970</span>-<span class="number">01</span>-<span class="number">02</span>,gender=M,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">2</span>,firstName=Susan,lastName=Davis,birthDate=<span class="number">1969</span>-<span class="number">02</span>-<span class="number">10</span>,gender=F,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">3</span>,firstName=John,lastName=Wilson,birthDate=<span class="number">1982</span>-<span class="number">05</span>-<span class="number">08</span>,gender=M,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">4</span>,firstName=Sharon,lastName=Johnson,birthDate=<span class="number">1990</span>-<span class="number">01</span>-<span class="number">20</span>,gender=F,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] &#123;empNo=<span class="number">5</span>,firstName=Stephen,lastName=Taylor,birthDate=<span class="number">2003</span>-<span class="number">12</span>-<span class="number">31</span>,gender=M,lockVersion=<span class="number">0</span>&#125;</span><br><span class="line">[INFO ] transaction rollback!</span><br><span class="line">[INFO ] insert with Entity</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">INSERT /* mapping @ Department */ INTO PUBLIC.DEPARTMENT(</span><br><span class="line">   DEPT_NO</span><br><span class="line">  , DEPT_NAME</span><br><span class="line">  , LOCK_VERSION</span><br><span class="line">) VALUES (</span><br><span class="line">   ?/*deptNo*/</span><br><span class="line">  , ?/*deptName*/</span><br><span class="line">  , ?/*lockVersion*/</span><br><span class="line">)</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[deptNo], Value[<span class="number">1005</span>], Class[Long]]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">2</span>], Parameter name[deptName], Value[information], Class[String]]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">3</span>], Parameter name[lockVersion], Value[<span class="number">0</span>], Class[Long]]</span><br><span class="line">[DEBUG] Execute update SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[DEBUG] Evaluation Expression：[deptNo != null], Result：[true], Parameter：[deptNo:[<span class="number">1005</span>]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(deptName)], Result：[false], Parameter：[deptName:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[lockVersion != null], Result：[false], Parameter：[lockVersion:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* mapping @ Department */</span><br><span class="line">   DEPT_NO  AS  DEPT_NO -- dept_no</span><br><span class="line">  , DEPT_NAME AS  DEPT_NAME -- dept_name</span><br><span class="line">  , LOCK_VERSION  AS  LOCK_VERSION  -- lock_version</span><br><span class="line">FROM PUBLIC.DEPARTMENT</span><br><span class="line">WHERE</span><br><span class="line">  DEPT_NO = ?/*deptNo*/</span><br><span class="line">ORDER BY </span><br><span class="line">   DEPT_NO</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[deptNo], Value[<span class="number">1005</span>], Class[Integer]]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] Department [deptNo=<span class="number">1005</span>, deptName=information, lockVersion=<span class="number">0</span>]</span><br><span class="line">[INFO ] update with Entity</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">UPDATE /* mapping @ Department */ PUBLIC.DEPARTMENT SET </span><br><span class="line">   DEPT_NO = ?/*deptNo*/</span><br><span class="line">  , DEPT_NAME = ?/*deptName*/</span><br><span class="line">  , LOCK_VERSION = ?/*lockVersion*/ + 1</span><br><span class="line">WHERE</span><br><span class="line">  DEPT_NO = ?/*deptNo*/</span><br><span class="line">  AND LOCK_VERSION = ?/*lockVersion*/</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[deptNo], Value[<span class="number">1005</span>], Class[Long]]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">2</span>], Parameter name[deptName], Value[Information System], Class[String]]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">3</span>], Parameter name[lockVersion], Value[<span class="number">0</span>], Class[Long]]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">4</span>], Parameter name[deptNo], Value[<span class="number">1005</span>], Class[Long]]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">5</span>], Parameter name[lockVersion], Value[<span class="number">0</span>], Class[Long]]</span><br><span class="line">[DEBUG] Execute update SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[DEBUG] Evaluation Expression：[deptNo != null], Result：[true], Parameter：[deptNo:[<span class="number">1005</span>]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(deptName)], Result：[false], Parameter：[deptName:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[lockVersion != null], Result：[false], Parameter：[lockVersion:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* mapping @ Department */</span><br><span class="line">   DEPT_NO  AS  DEPT_NO -- dept_no</span><br><span class="line">  , DEPT_NAME AS  DEPT_NAME -- dept_name</span><br><span class="line">  , LOCK_VERSION  AS  LOCK_VERSION  -- lock_version</span><br><span class="line">FROM PUBLIC.DEPARTMENT</span><br><span class="line">WHERE</span><br><span class="line">  DEPT_NO = ?/*deptNo*/</span><br><span class="line">ORDER BY </span><br><span class="line">   DEPT_NO</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[deptNo], Value[<span class="number">1005</span>], Class[Integer]]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] Department [deptNo=<span class="number">1005</span>, deptName=Information System, lockVersion=<span class="number">1</span>]</span><br><span class="line">[INFO ] delete with Entity</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">DELETE /* mapping @ Department */ FROM PUBLIC.DEPARTMENT</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute update SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[DEBUG] Evaluation Expression：[deptNo != null], Result：[true], Parameter：[deptNo:[<span class="number">1005</span>]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(deptName)], Result：[false], Parameter：[deptName:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[lockVersion != null], Result：[false], Parameter：[lockVersion:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* mapping @ Department */</span><br><span class="line">   DEPT_NO  AS  DEPT_NO -- dept_no</span><br><span class="line">  , DEPT_NAME AS  DEPT_NAME -- dept_name</span><br><span class="line">  , LOCK_VERSION  AS  LOCK_VERSION  -- lock_version</span><br><span class="line">FROM PUBLIC.DEPARTMENT</span><br><span class="line">WHERE</span><br><span class="line">  DEPT_NO = ?/*deptNo*/</span><br><span class="line">ORDER BY </span><br><span class="line">   DEPT_NO</span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[deptNo], Value[<span class="number">1005</span>], Class[Integer]]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [null] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO ] deptNo = <span class="number">1005</span> deleted!!</span><br><span class="line">[INFO ] transaction rollback!</span><br><span class="line">[INFO ] employee/select_employee after transaction select. employee is empty.</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(emp_no)], Result：[false], Parameter：[emp_no:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(first_name)], Result：[false], Parameter：[first_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(last_name)], Result：[false], Parameter：[last_name:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_from)], Result：[false], Parameter：[birth_date_from:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(birth_date_to)], Result：[false], Parameter：[birth_date_to:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[gender_list != null], Result：[false], Parameter：[gender_list:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[female != null and female], Result：[false], Parameter：[female:[null],female:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* employee/select_employee */</span><br><span class="line">  EMP.EMP_NO      AS  EMP_NO</span><br><span class="line">, EMP.FIRST_NAME    AS  FIRST_NAME</span><br><span class="line">, EMP.LAST_NAME   AS  LAST_NAME</span><br><span class="line">, EMP.BIRTH_DATE    AS  BIRTH_DATE</span><br><span class="line">, EMP.GENDER      AS  GENDER</span><br><span class="line">, EMP.LOCK_VERSION  AS  LOCK_VERSION</span><br><span class="line">FROM</span><br><span class="line">  EMPLOYEE  EMP</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [employee/select_employee] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">000</span>]</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] BUILD SUCCESS</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br><span class="line">[INFO] Total <span class="built_in">time</span>: <span class="number">1</span>.<span class="number">510</span> s</span><br><span class="line">[INFO] Finished <span class="built_in">at</span>: XXXX-XX-XXT13:<span class="number">56</span>:<span class="number">04</span>+<span class="number">09</span>:<span class="number">00</span></span><br><span class="line">[INFO] Final Memory: <span class="number">15</span>M/<span class="number">361</span>M</span><br><span class="line">[INFO] ------------------------------------------------------------------------</span><br></pre></td></tr></table></figure></p>
<h2 id="サンプルプロジェクトの構成"><a href="#サンプルプロジェクトの構成" class="headerlink" title="サンプルプロジェクトの構成"></a>サンプルプロジェクトの構成</h2><p>ではサンプルアプリケーションの構成を見ていきましょう。</p>
<figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">uroborosql-sample</span><br><span class="line">  ├─REPL</span><br><span class="line">  │  └─repl.properties</span><br><span class="line">  └─src</span><br><span class="line"><span class="code">     └─main</span></span><br><span class="line"><span class="code">        ├─java</span></span><br><span class="line"><span class="code">        │  └─jp</span></span><br><span class="line"><span class="code">        │      └─co</span></span><br><span class="line"><span class="code">        │          └─future</span></span><br><span class="line"><span class="code">        │              └─uroborosql</span></span><br><span class="line"><span class="code">        │                  └─sample</span></span><br><span class="line"><span class="code">        │                      └─Main.java</span></span><br><span class="line"><span class="code">        │                      └─entity</span></span><br><span class="line"><span class="code">        │                      │   └─Department.java</span></span><br><span class="line"><span class="code">        │                      │   └─Employee.java</span></span><br><span class="line"><span class="code">        │                      └─type</span></span><br><span class="line"><span class="code">        │                          └─Gender.java</span></span><br><span class="line"><span class="code">        └─resources</span></span><br><span class="line"><span class="code">            ├─logback.xml</span></span><br><span class="line"><span class="code">            ├─data</span></span><br><span class="line"><span class="code">            │   ├─department.tsv</span></span><br><span class="line"><span class="code">            │   ├─dept_emp.tsv</span></span><br><span class="line"><span class="code">            │   └─employee.tsv</span></span><br><span class="line"><span class="code">            └─sql</span></span><br><span class="line"><span class="code">                ├─ddl</span></span><br><span class="line"><span class="code">                │   └─create_tables.sql</span></span><br><span class="line"><span class="code">                └─setup</span></span><br><span class="line"><span class="code">                │   └─insert_data.sql</span></span><br><span class="line"><span class="code">                ├─department</span></span><br><span class="line"><span class="code">                │   ├─insert_department.sql</span></span><br><span class="line"><span class="code">                │   └─select_department.sql</span></span><br><span class="line"><span class="code">                ├─employee</span></span><br><span class="line"><span class="code">                │   ├─insert_employee.sql</span></span><br><span class="line"><span class="code">                │   └─select_employee.sql</span></span><br><span class="line"><span class="code">                └─relation</span></span><br><span class="line"><span class="code">                    └─insert_dept_emp.sql</span></span><br></pre></td></tr></table></figure>
<p>主要なファイルの説明です</p>
<table>
<thead>
<tr>
<th style="text-align:left">ファイル</th>
<th style="text-align:left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Main.java</td>
<td style="text-align:left">uroborosql-sampleのメインプログラムです。</td>
</tr>
<tr>
<td style="text-align:left">Department.java / Employee.java</td>
<td style="text-align:left">テーブル構造を表すEntityクラスです。メインプログラムの中で使用します。</td>
</tr>
<tr>
<td style="text-align:left">Gender.java</td>
<td style="text-align:left">性別を表すEnumクラスです。メインプログラムの中で使用します。</td>
</tr>
<tr>
<td style="text-align:left">sqlフォルダ配下のSQL</td>
<td style="text-align:left">uroborosqlで実行するSQLファイルです。</td>
</tr>
<tr>
<td style="text-align:left">dataフォルダ配下のTSV</td>
<td style="text-align:left">テーブルデータ作成用のTSVファイルです。Mainクラスの中でテーブルへの一括データ投入を行う際のデータとして利用します。</td>
</tr>
<tr>
<td style="text-align:left">logback.xml</td>
<td style="text-align:left">ログ出力設定ファイルです。</td>
</tr>
</tbody>
</table>
<h2 id="SQLの実行方法"><a href="#SQLの実行方法" class="headerlink" title="SQLの実行方法"></a>SQLの実行方法</h2><p>Main.javaを見ていきましょう。</p>
<p>mainメソッドの中で最初にSqlConfigクラスを作成しています。<br>ここでは<a href="http://www.h2database.com/html/main.html" target="_blank" rel="noopener">H2DB</a>のメモリDBに接続するSqlConfigインスタンスを生成しています。<br>SqlConfigの生成にはUroboroSQLクラスによるBuilderAPIを使用します。</p>
<ul>
<li>基本的な呼出方法（DBへの接続情報のみ指定）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create SqlConfig</span></span><br><span class="line">SqlConfig config = UroboroSQL.builder(<span class="string">"jdbc:h2:mem:test;DB_CLOSE_DELAY=-1"</span>, <span class="string">"sa"</span>, <span class="string">""</span>).build();</span><br></pre></td></tr></table></figure>
<ul>
<li>設定のカスタマイズ（定数の指定や検索結果の取得方法変更）</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create SqlConfig</span></span><br><span class="line">SqlConfig config = UroboroSQL</span><br><span class="line">    .builder(<span class="string">"jdbc:h2:mem:test;DB_CLOSE_DELAY=-1"</span>, <span class="string">"sa"</span>, <span class="string">""</span>)</span><br><span class="line">      <span class="comment">// SqlContextFactoryの設定（Enum定数パッケージ設定の追加）</span></span><br><span class="line">      .setSqlContextFactory(<span class="keyword">new</span> SqlContextFactoryImpl()</span><br><span class="line">        .setEnumConstantPackageNames(Arrays.asList(Gender.class.getPackage().getName())))</span><br><span class="line">      <span class="comment">// SqlAgentFactoryの設定（Queryの戻り値のMapのキー文字列のデフォルトCaseFormat設定の追加）</span></span><br><span class="line">      .setSqlAgentFactory(<span class="keyword">new</span> SqlAgentFactoryImpl().setDefaultMapKeyCaseFormat(CaseFormat.CAMEL_CASE))</span><br><span class="line">    .build();</span><br></pre></td></tr></table></figure>
<p>SqlConfig生成時のカスタマイズの詳細については <a href="../advanced">高度な操作</a>を参照してください。</p>
<p>次に生成したSqlConfigからuroboroSQLの中核となるクラスであるSqlAgentを生成します。<br>uroboroSQLのそれぞれの処理はSqlAgentを使って呼び出します。<br>SqlAgentはAutoClosableインタフェースを実装しているので、try-with-resources文で囲むことで処理終了時にクローズされます。<br>このときSqlAgentの中に保持するConnectionなどもクローズされるため、クローズ漏れによるメモリリークを防ぐことができます。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create SqlAgent. SqlAgent implements AutoClosable.</span></span><br><span class="line"><span class="keyword">try</span> (SqlAgent agent = config.agent()) &#123;</span><br><span class="line">  <span class="comment">// ここにSQL発行の処理を実装する</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以降の処理はtry-with-resourcesの中で行います。</p>
<p>接続したDBにテーブルを作成と初期データの登録を行います。<br>uroboroSQLでは実行するSQLをファイルパスに似た表現（<code>SQL名</code>と呼ぶ）で指定します。<br>下の例ではクラスパス上にあるsqlフォルダ配下のddl/create_tables.sqlを指定してSQL更新処理を実行します。</p>
<p>更新処理を行う場合、<code>SqlAgent#update(&quot;[SQL名]&quot;)</code>メソッドを使用してSqlUpdateを取得し、続けてバインドパラメータの設定や<br>Updateの実行を行います。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create table :  テーブル作成</span></span><br><span class="line">agent.update(<span class="string">"ddl/create_tables"</span>).count();</span><br><span class="line"><span class="comment">// setup data : 初期データ挿入</span></span><br><span class="line">agent.update(<span class="string">"setup/insert_data"</span>).count();</span><br></pre></td></tr></table></figure>
<p>ddl/create_tables.sqlで作成したテーブルの構成は以下になります。<br><img src="erd.png" alt="ERD" title="テーブル構成"></p>
<p>登録したデータを検索してみましょう。<br>検索を行う際は、<code>SqlAgent#query(&quot;[SQL名]&quot;)</code>メソッドを使用してSqlQueryを取得し、続けてバインドパラメータの設定や<br>Queryの実行を行います。</p>
<p>uroboroSQLでは検索結果をいくつかの形式で取得することができます。</p>
<table>
<thead>
<tr>
<th style="text-align:left">メソッド</th>
<th style="text-align:left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">SqlQuery#collect()</td>
<td style="text-align:left">検索結果の各行をMapに詰めたListの形式で取得する</td>
</tr>
<tr>
<td style="text-align:left">SqlQuery#stream()</td>
<td style="text-align:left">検索結果をJava8で追加されたStreamの形式で取得する</td>
</tr>
<tr>
<td style="text-align:left">SqlQuery#resultSet()</td>
<td style="text-align:left">検索結果のResultSetを取得する</td>
</tr>
<tr>
<td style="text-align:left">SqlQuery#first()</td>
<td style="text-align:left">検索結果の１件目を取得する。取得できない場合はRuntimeException</td>
</tr>
<tr>
<td style="text-align:left">SqlQuery#findFirst()</td>
<td style="text-align:left">検索結果の１件目を取得する。戻り値はOptional</td>
</tr>
</tbody>
</table>
<p>例えば、以下のように呼び出します。</p>
<ul>
<li>検索結果の各行をMapに詰めたListの形式で取得する</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Map&lt;String, Object&gt;&gt; departments = agent.query(<span class="string">"department/select_department"</span>)</span><br><span class="line">  .param(<span class="string">"dept_no"</span>, <span class="number">1001</span>)</span><br><span class="line">  .collect();</span><br></pre></td></tr></table></figure>
<ul>
<li>検索結果をJava8で追加されたStreamの形式で取得する</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">agent.query(<span class="string">"employee/select_employee"</span>)</span><br><span class="line">  .paramList(<span class="string">"gender_list"</span>, Gender.FEMALE, Gender.MALE)</span><br><span class="line">  .stream().forEach(m -&gt; log(toS(m)));</span><br></pre></td></tr></table></figure>
<p>ここで実行されるSQLは以下のようになっています。</p>
<ul>
<li>department/select_department.sql</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="comment">/* _SQL_ID_ */</span></span><br><span class="line">  DEPT.DEPT_NO  <span class="keyword">AS</span>  DEPT_NO</span><br><span class="line">,  DEPT.DEPT_NAME  <span class="keyword">AS</span>  DEPT_NAME</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">  DEPARTMENT  DEPT</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">  <span class="number">1</span>        =  <span class="number">1</span></span><br><span class="line"><span class="comment">/*IF SF.isNotEmpty(dept_no)*/</span></span><br><span class="line"><span class="keyword">AND</span>  DEPT.DEPT_NO  =  <span class="comment">/*dept_no*/</span><span class="number">1</span></span><br><span class="line"><span class="comment">/*END*/</span></span><br><span class="line"><span class="comment">/*IF SF.isNotEmpty(dept_name)*/</span></span><br><span class="line"><span class="keyword">AND</span>  DEPT.DEPT_NAME  =  <span class="comment">/*dept_name*/</span><span class="string">'sample'</span></span><br><span class="line"><span class="comment">/*END*/</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>/* _SQL_ID_ */</code> はSQLを特定するID(SQL_IDといいます)を付与するための予約語で、実行時にSQLファイルを特定するための文字列に変換されます。</li>
<li><code>/*IF*/ ... /*END*/</code>は条件分岐で、IFの後ろの評価結果が<code>True</code>となる場合に<code>/*IF*/</code>と<code>/*END*/</code>で囲まれた部分が出力されます。</li>
<li><code>/*dept_no*/</code>はバインドパラメータで、実行時に<code>?</code>に変換され、SqlQueryに設定したパラメータがSQLへバインドされます。</li>
<li><code>/*dept_no*/</code>の後ろの<code>1</code>はテスト用データです。このようにテスト用データをSQL文に記述しておくことで、このSQLを<br>SQLクライアントツールで実行する際にエラーにならずに文法の確認を行うことができます。</li>
</ul>
<p>SQLで使用できる構文の詳細については<a href="../basics/#2WaySQL">2WaySQL</a>を参照してください。</p>
<p>処理結果のCommitやRollbackもSqlAgent経由で行います。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// commit</span></span><br><span class="line">agent.commit();</span><br><span class="line"></span><br><span class="line"><span class="comment">// rollback</span></span><br><span class="line">agent.rollback();</span><br></pre></td></tr></table></figure>
<p>uroboroSQLでは、これらの基本的な操作のほか、バッチ処理やトランザクション処理なども行うことができます。<br>詳細については<a href="../basics/#基本操作">基本操作</a>を参照してください。</p>
<h2 id="SQL-REPL"><a href="#SQL-REPL" class="headerlink" title="SQL-REPL"></a>SQL-REPL</h2><p>ここまではJavaアプリケーションからuroboroSQLを利用する場合の説明でした。<br>uroboroSQLにはもう一つ特徴的な機能として、SQLを対話しながら実行するためのREPL機能を提供しています。</p>
<p>今度はこのREPL機能を利用してみましょう。</p>
<p>REPLを起動するためには<code>jp.co.future.uroborosql.client.SqlREPL</code>クラスを実行する必要があります。<br>サンプルアプリケーションでSqlREPLクラスを実行するためには以下のコマンドを実行します。<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -PREPL</span><br></pre></td></tr></table></figure></p>
<p>実行すると以下のようにタイトル表示とコマンド説明、設定値の情報が表示され、そのあとコマンド入力状態になります。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">===========================================================</span><br><span class="line">                 _                    ____   ___  _</span><br><span class="line"> _   _ _ __ ___ | |__   ___  _ __ ___/ ___| / _ \| |</span><br><span class="line">| | | | '__/ _ \| '_ \ / _ \| '__/ _ \___ \| | | | |</span><br><span class="line">| |_| | | | (_) | |_) | (_) | | | (_) |__) | |_| | |___</span><br><span class="line"> \__,_|_|  \___/|_.__/ \___/|_|  \___/____/ \__\_\_____|</span><br><span class="line"></span><br><span class="line">uroboroSQL SQL REPL <span class="built_in">ver</span>.<span class="number">0</span>.<span class="number">5</span>.<span class="number">0</span></span><br><span class="line">===========================================================</span><br><span class="line"></span><br><span class="line">Commands :</span><br><span class="line">        query   : execute query from loaded sql file.</span><br><span class="line">                ex1) query [sql file name]&lt;Enter&gt; : Execute SQL without parameter.</span><br><span class="line">                ex2) query [sql file name] param1=val1 param2=val2 ...&lt;Enter&gt; : Execute SQL with the specified parameters.</span><br><span class="line">        update  : execute update from loaded sql file.</span><br><span class="line">                ex1) update [sql file name]&lt;Enter&gt; : Execute SQL without parameter.</span><br><span class="line">                ex2) update [sql file name] param1=val1 param2=val2 ...&lt;Enter&gt; : Execute SQL with the specified parameters.</span><br><span class="line">        view    : view sql file.</span><br><span class="line">                ex) view [sql file name]&lt;Enter&gt; : Show sql file contents.</span><br><span class="line">        list    : list loaded sql files.</span><br><span class="line">                ex1) list&lt;Enter&gt; : Show all loaded sql file(s).</span><br><span class="line">                ex2) list keyword&lt;Enter&gt; : Show loaded sql file(s) filter by keyword.</span><br><span class="line">        history : list command history.</span><br><span class="line">                ex1) history&lt;Enter&gt; : Show all command history.</span><br><span class="line">                ex2) history keyword&lt;Enter&gt; : Show command history filter by keyword.</span><br><span class="line">        driver  : list loaded drivers.</span><br><span class="line">        reload  : reload sql files.</span><br><span class="line">        <span class="built_in">cls</span>     : clear screen.</span><br><span class="line">        <span class="built_in">help</span>    : show this message.</span><br><span class="line">        <span class="keyword">exit</span>    : <span class="keyword">exit</span> SQL REPL. `CTRL+C` is an alias.</span><br><span class="line"></span><br><span class="line">[Properties]</span><br><span class="line">db.url=jdbc:h2:file:./target/db/repldb;</span><br><span class="line">sql.additionalClassPath=src/main/resources;$&#123;user.home&#125;/.m2/repository/com/h2database/h2/<span class="number">1</span>.<span class="number">4</span>.<span class="number">192</span>/h2-<span class="number">1</span>.<span class="number">4</span>.<span class="number">192</span>.jar</span><br><span class="line">db.user=sa</span><br><span class="line">db.password=</span><br><span class="line"></span><br><span class="line">uroborosql &gt;</span><br></pre></td></tr></table></figure>
<p>まずは<code>help[Enter]</code>と入力してみましょう。<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">uroborosql &gt; <span class="built_in">help</span>[Enter]</span><br><span class="line"><span class="function">HELP:</span></span><br><span class="line"><span class="function">===========================================================</span></span><br><span class="line"><span class="function">                 <span class="title">_</span>                    <span class="title">____</span>   <span class="title">___</span>  <span class="title">_</span></span></span><br><span class="line"><span class="function"> <span class="title">_</span>   <span class="title">_</span> <span class="title">_</span> <span class="title">__</span> <span class="title">___</span> | |<span class="title">__</span>   <span class="title">___</span>  <span class="title">_</span> <span class="title">__</span> <span class="title">___</span>/ <span class="title">___</span>| / <span class="title">_</span> \| |</span></span><br><span class="line"><span class="function">| | | | '<span class="title">__</span>/ <span class="title">_</span> \| '<span class="title">_</span> \ / <span class="title">_</span> \| '<span class="title">__</span>/ <span class="title">_</span> \<span class="title">___</span> \| | | | |</span></span><br><span class="line"><span class="function">| |<span class="title">_</span>| | | | (<span class="title">_</span>) | |<span class="title">_</span>) | (<span class="title">_</span>) | | | (<span class="title">_</span>) |<span class="title">__</span>) | |<span class="title">_</span>| | |<span class="title">___</span></span></span><br><span class="line"><span class="function"> \<span class="title">__</span>,<span class="title">_</span>|<span class="title">_</span>|  \<span class="title">___</span>/|<span class="title">_.__</span>/ \<span class="title">___</span>/|<span class="title">_</span>|  \<span class="title">___</span>/<span class="title">____</span>/ \<span class="title">__</span>\<span class="title">_</span>\<span class="title">_____</span>|</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">uroboroSQL</span> <span class="title">SQL</span> <span class="title">REPL</span> <span class="title">ver</span>.0.5.0</span></span><br><span class="line"><span class="function">===========================================================</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">Commands</span> :</span></span><br><span class="line"><span class="function">        <span class="title">query</span>   : <span class="title">execute</span> <span class="title">query</span> <span class="title">from</span> <span class="title">loaded</span> <span class="title">sql</span> <span class="title">file</span>.</span></span><br><span class="line"><span class="function">                <span class="title">ex1</span>) <span class="title">query</span> [<span class="title">sql</span> <span class="title">file</span> <span class="title">name</span>]&lt;<span class="title">Enter</span>&gt; : <span class="title">Execute</span> <span class="title">SQL</span> <span class="title">without</span> <span class="title">parameter</span>.</span></span><br><span class="line"><span class="function">                <span class="title">ex2</span>) <span class="title">query</span> [<span class="title">sql</span> <span class="title">file</span> <span class="title">name</span>] <span class="title">param1</span>=<span class="title">val1</span> <span class="title">param2</span>=<span class="title">val2</span> ...&lt;<span class="title">Enter</span>&gt; : <span class="title">Execute</span> <span class="title">SQL</span> <span class="title">with</span> <span class="title">the</span> <span class="title">specified</span> <span class="title">parameters</span>.</span></span><br><span class="line"><span class="function">        <span class="title">update</span>  : <span class="title">execute</span> <span class="title">update</span> <span class="title">from</span> <span class="title">loaded</span> <span class="title">sql</span> <span class="title">file</span>.</span></span><br><span class="line"><span class="function">                <span class="title">ex1</span>) <span class="title">update</span> [<span class="title">sql</span> <span class="title">file</span> <span class="title">name</span>]&lt;<span class="title">Enter</span>&gt; : <span class="title">Execute</span> <span class="title">SQL</span> <span class="title">without</span> <span class="title">parameter</span>.</span></span><br><span class="line"><span class="function">                <span class="title">ex2</span>) <span class="title">update</span> [<span class="title">sql</span> <span class="title">file</span> <span class="title">name</span>] <span class="title">param1</span>=<span class="title">val1</span> <span class="title">param2</span>=<span class="title">val2</span> ...&lt;<span class="title">Enter</span>&gt; : <span class="title">Execute</span> <span class="title">SQL</span> <span class="title">with</span> <span class="title">the</span> <span class="title">specified</span> <span class="title">parameters</span>.</span></span><br><span class="line"><span class="function">        <span class="title">view</span>    : <span class="title">view</span> <span class="title">sql</span> <span class="title">file</span>.</span></span><br><span class="line"><span class="function">                <span class="title">ex</span>) <span class="title">view</span> [<span class="title">sql</span> <span class="title">file</span> <span class="title">name</span>]&lt;<span class="title">Enter</span>&gt; : <span class="title">Show</span> <span class="title">sql</span> <span class="title">file</span> <span class="title">contents</span>.</span></span><br><span class="line"><span class="function">        <span class="title">list</span>    : <span class="title">list</span> <span class="title">loaded</span> <span class="title">sql</span> <span class="title">files</span>.</span></span><br><span class="line"><span class="function">                <span class="title">ex1</span>) <span class="title">list</span>&lt;<span class="title">Enter</span>&gt; : <span class="title">Show</span> <span class="title">all</span> <span class="title">loaded</span> <span class="title">sql</span> <span class="title">file</span>(<span class="title">s</span>).</span></span><br><span class="line"><span class="function">                <span class="title">ex2</span>) <span class="title">list</span> <span class="title">keyword</span>&lt;<span class="title">Enter</span>&gt; : <span class="title">Show</span> <span class="title">loaded</span> <span class="title">sql</span> <span class="title">file</span>(<span class="title">s</span>) <span class="title">filter</span> <span class="title">by</span> <span class="title">keyword</span>.</span></span><br><span class="line"><span class="function">        <span class="title">history</span> : <span class="title">list</span> <span class="title">command</span> <span class="title">history</span>.</span></span><br><span class="line"><span class="function">                <span class="title">ex1</span>) <span class="title">history</span>&lt;<span class="title">Enter</span>&gt; : <span class="title">Show</span> <span class="title">all</span> <span class="title">command</span> <span class="title">history</span>.</span></span><br><span class="line"><span class="function">                <span class="title">ex2</span>) <span class="title">history</span> <span class="title">keyword</span>&lt;<span class="title">Enter</span>&gt; : <span class="title">Show</span> <span class="title">command</span> <span class="title">history</span> <span class="title">filter</span> <span class="title">by</span> <span class="title">keyword</span>.</span></span><br><span class="line"><span class="function">        <span class="title">driver</span>  : <span class="title">list</span> <span class="title">loaded</span> <span class="title">drivers</span>.</span></span><br><span class="line"><span class="function">        <span class="title">reload</span>  : <span class="title">reload</span> <span class="title">sql</span> <span class="title">files</span>.</span></span><br><span class="line"><span class="function">        <span class="title">cls</span>     : <span class="title">clear</span> <span class="title">screen</span>.</span></span><br><span class="line"><span class="function">        <span class="title">help</span>    : <span class="title">show</span> <span class="title">this</span> <span class="title">message</span>.</span></span><br><span class="line"><span class="function">        <span class="title">exit</span>    : <span class="title">exit</span> <span class="title">SQL</span> <span class="title">REPL</span>. `<span class="title">CTRL</span>+<span class="title">C</span>` <span class="title">is</span> <span class="title">an</span> <span class="title">alias</span>.</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">uroborosql</span> &gt;</span></span><br></pre></td></tr></table></figure></p>
<p>ヘルプが表示され、使用できるコマンドの一覧が表示されます。</p>
<p>REPLを立ち上げた状態では接続したDB（H2DB メモリDB）には何もない状態なので、まずはテーブルを作成します。<br>サンプルアプリケーションで利用できるSQLファイルを確認しましょう。</p>
<p><code>list[Enter]</code>と入力します。<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">uroborosql &gt; list[Enter]</span><br><span class="line"><span class="function">LIST:</span></span><br><span class="line"><span class="function"><span class="title">ddl</span>/<span class="title">create_tables</span></span></span><br><span class="line"><span class="function"><span class="title">employee</span>/<span class="title">select_employee</span></span></span><br><span class="line"><span class="function"><span class="title">employee</span>/<span class="title">insert_employee</span></span></span><br><span class="line"><span class="function"><span class="title">department</span>/<span class="title">insert_department</span></span></span><br><span class="line"><span class="function"><span class="title">setup</span>/<span class="title">insert_data</span></span></span><br><span class="line"><span class="function"><span class="title">department</span>/<span class="title">select_department</span></span></span><br><span class="line"><span class="function"><span class="title">relation</span>/<span class="title">insert_dept_emp</span></span></span><br><span class="line"><span class="function"><span class="title">uroborosql</span> &gt;</span></span><br></pre></td></tr></table></figure></p>
<p>ロード済みのSQLファイルのSQL名がわかります。<br>テーブルを作成するために<code>ddl/create_tables</code>を実行します。<br><code>ddl/create_tables</code>はDDLなので実行するためには<code>update</code>コマンドを使用します。<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&gt; update ddl/create_tables[Enter]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">-- employee</span><br><span class="line">drop table <span class="keyword">if</span> exists employee cascade;</span><br><span class="line">create table employee (</span><br><span class="line">  emp_no NUMBER(<span class="number">11</span>) <span class="keyword">not</span> null</span><br><span class="line">  , first_name VARCHAR(<span class="number">20</span>) <span class="keyword">not</span> null</span><br><span class="line">  , last_name VARCHAR(<span class="number">20</span>) <span class="keyword">not</span> null</span><br><span class="line">  , birth_date <span class="built_in">DATE</span> <span class="keyword">not</span> null</span><br><span class="line">  , gender CHAR(<span class="number">1</span>) <span class="keyword">not</span> null</span><br><span class="line">  , constraint employee_PKC primary key (emp_no)</span><br><span class="line">) ;</span><br><span class="line">-- dept_emp</span><br><span class="line">drop table <span class="keyword">if</span> exists dept_emp cascade;</span><br><span class="line">create table dept_emp (</span><br><span class="line">  emp_no NUMBER(<span class="number">11</span>) <span class="keyword">not</span> null</span><br><span class="line">  , dept_no NUMBER(<span class="number">4</span>) <span class="keyword">not</span> null</span><br><span class="line">  , constraint dept_emp_PKC primary key (emp_no,dept_no)</span><br><span class="line">) ;</span><br><span class="line">-- department</span><br><span class="line">drop table <span class="keyword">if</span> exists department cascade;</span><br><span class="line">create table department (</span><br><span class="line">  dept_no NUMBER(<span class="number">4</span>) <span class="keyword">not</span> null</span><br><span class="line">  , dept_name VARCHAR(<span class="number">100</span>) <span class="keyword">not</span> null</span><br><span class="line">  , constraint department_PKC primary key (dept_no)</span><br><span class="line">) ;</span><br><span class="line">comment on table employee is 'employee';</span><br><span class="line">comment on column employee.emp_no is 'emp_no';</span><br><span class="line">comment on column employee.first_name is 'first_name';</span><br><span class="line">comment on column employee.last_name is 'last_name';</span><br><span class="line">comment on column employee.birth_date is 'birth_date';</span><br><span class="line">comment on column employee.gender is 'gender     ''F''emale/''M''ale/''O''ther';</span><br><span class="line">comment on table dept_emp is 'dept_emp';</span><br><span class="line">comment on column dept_emp.emp_no is 'emp_no';</span><br><span class="line">comment on column dept_emp.dept_no is 'dept_no';</span><br><span class="line">comment on table department is 'department';</span><br><span class="line">comment on column department.dept_no is 'dept_no';</span><br><span class="line">comment on column department.dept_name is 'dept_name'</span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute update SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [ddl/create_tables] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">008</span>]</span><br><span class="line">update sql[ddl/create_tables] end. row count=<span class="number">0</span></span><br><span class="line">uroborosql &gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
<p><code>ddl/create_tables</code>が実行され、DBにテーブルが作成されました。<br>続いて初期データを投入しましょう。</p>
<p><code>setup/insert_data</code>を実行します。<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&gt; update setup/insert_data[Enter]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">insert into department (dept_no, dept_name) values (<span class="number">1001</span>, 'sales');</span><br><span class="line">insert into department (dept_no, dept_name) values (<span class="number">1002</span>, 'export');</span><br><span class="line">insert into department (dept_no, dept_name) values (<span class="number">1003</span>, 'accounting');</span><br><span class="line">insert into department (dept_no, dept_name) values (<span class="number">1004</span>, 'personnel');</span><br><span class="line">insert into employee (emp_no, first_name, last_name, birth_date, gender) values (<span class="number">0001</span>, 'Bob', 'Smith', '<span class="number">1970</span>-<span class="number">01</span>-<span class="number">02</span>', 'M');</span><br><span class="line">insert into employee (emp_no, first_name, last_name, birth_date, gender) values (<span class="number">0002</span>, 'Susan', 'Davis', '<span class="number">1969</span>-<span class="number">02</span>-<span class="number">10</span>', 'F');</span><br><span class="line">insert into employee (emp_no, first_name, last_name, birth_date, gender) values (<span class="number">0003</span>, 'John', 'Wilson', '<span class="number">1982</span>-<span class="number">05</span>-<span class="number">08</span>', 'M');</span><br><span class="line">insert into employee (emp_no, first_name, last_name, birth_date, gender) values (<span class="number">0004</span>, 'Sharon', 'Johnson', '<span class="number">1990</span>-<span class="number">01</span>-<span class="number">20</span>', 'F');</span><br><span class="line">insert into employee (emp_no, first_name, last_name, birth_date, gender) values (<span class="number">0005</span>, 'Stephen', 'Taylor', '<span class="number">2003</span>-<span class="number">12</span>-<span class="number">31</span>', 'M');</span><br><span class="line">insert into dept_emp (emp_no, dept_no) values (<span class="number">0001</span>, '<span class="number">1001</span>');</span><br><span class="line">insert into dept_emp (emp_no, dept_no) values (<span class="number">0002</span>, '<span class="number">1001</span>');</span><br><span class="line">insert into dept_emp (emp_no, dept_no) values (<span class="number">0003</span>, '<span class="number">1002</span>');</span><br><span class="line">insert into dept_emp (emp_no, dept_no) values (<span class="number">0004</span>, '<span class="number">1003</span>');</span><br><span class="line">insert into dept_emp (emp_no, dept_no) values (<span class="number">0005</span>, '<span class="number">1004</span>')</span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute update SQL.</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [setup/insert_data] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">003</span>]</span><br><span class="line">update sql[setup/insert_data] end. row count=<span class="number">1</span></span><br><span class="line">uroborosql &gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
<p>これで書くテーブルに初期データが挿入されました。<br>では、挿入したデータを検索してみましょう。</p>
<p>検索を行う場合は<code>query</code>コマンドを使用します。<br><code>query</code>の後に実行するSQLを指定します。<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&gt; query department/select_department[Enter]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(dept_no)], Result：[false], Parameter：[dept_no:[null]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(dept_name)], Result：[false], Parameter：[dept_name:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* department/select_department */</span><br><span class="line">        DEPT.DEPT_NO    AS      DEPT_NO</span><br><span class="line">,       DEPT.DEPT_NAME  AS      DEPT_NAME</span><br><span class="line">FROM</span><br><span class="line">        DEPARTMENT      DEPT</span><br><span class="line">WHERE</span><br><span class="line">        <span class="number">1</span>                               =       <span class="number">1</span></span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[INFO ]</span><br><span class="line">+-------+----------+</span><br><span class="line">|DEPT_NO|DEPT_NAME |</span><br><span class="line">+-------+----------+</span><br><span class="line">|   <span class="number">1001</span>|sales     |</span><br><span class="line">|   <span class="number">1002</span>|export    |</span><br><span class="line">|   <span class="number">1003</span>|accounting|</span><br><span class="line">|   <span class="number">1004</span>|personnel |</span><br><span class="line">+-------+----------+</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [department/select_department] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">009</span>]</span><br><span class="line">query sql[department/select_department] end.</span><br><span class="line">uroborosql &gt;</span><br></pre></td></tr></table></figure></p>
<p>ここではバインドパラメータを指定しなかったため、絞込み条件のないSQLが実行され検索結果として4件のデータが取得できました。</p>
<p>REPLでは上の結果のように、</p>
<ul>
<li>実行するSQL</li>
<li>バインドパラメータ</li>
<li>SQL文の中の評価式とその評価結果</li>
<li>検索結果</li>
<li>実行時間</li>
</ul>
<p>が表示されるので、どういう風にSQLが実行されたのかが良く分かるようになっています。</p>
<p>次にバインドパラメータを指定して検索してみましょう。<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">uroborosql &gt; query department/select_department dept_no=<span class="number">1001</span></span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(dept_no)], Result：[true], Parameter：[dept_no:[<span class="number">1001</span>]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(dept_name)], Result：[false], Parameter：[dept_name:[null]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* department/select_department */</span><br><span class="line">        DEPT.DEPT_NO    AS      DEPT_NO</span><br><span class="line">,       DEPT.DEPT_NAME  AS      DEPT_NAME</span><br><span class="line">FROM</span><br><span class="line">        DEPARTMENT      DEPT</span><br><span class="line">WHERE</span><br><span class="line">        <span class="number">1</span>                               =       <span class="number">1</span></span><br><span class="line">AND     DEPT.DEPT_NO    =       ?/*dept_no*/</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[dept_no], Value[<span class="number">1001</span>], Class[Integer]]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[INFO ]</span><br><span class="line">+-------+---------+</span><br><span class="line">|DEPT_NO|DEPT_NAME|</span><br><span class="line">+-------+---------+</span><br><span class="line">|   <span class="number">1001</span>|sales    |</span><br><span class="line">+-------+---------+</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [department/select_department] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">001</span>]</span><br><span class="line">query sql[department/select_department] end.</span><br><span class="line">uroborosql &gt;</span><br></pre></td></tr></table></figure></p>
<p><code>dept_no</code>に1001を指定して検索しています。<br>この時、SQL文の評価式である/*IF SF.isNotEmpty(dept_no)*/が<code>true</code>となりSQLのWHERE句にDEPT_NOの条件が追加されバインドパラメータがバインドされます。<br>その結果、検索結果は1件になっています。</p>
<p>このようにSQL名の後ろに<code>バインドパラメータ名</code>=<code>値</code>という形でバインドパラメータを記述することでバインドパラメータを指定してSQLを実行することができます。</p>
<p>バインドパラメータが複数ある場合は<code>バインドパラメータ名1</code>=<code>値1</code> <code>バインドパラメータ名2</code>=<code>値2</code> … という風に各パラメータの間を空白で区切って指定してください。</p>
<ul>
<li>バインドパラメータを複数指定する例<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">uroborosql &gt; query department/select_department dept_no=<span class="number">1001</span> dept_name=sales</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(dept_no)], Result：[true], Parameter：[dept_no:[<span class="number">1001</span>]]</span><br><span class="line">[DEBUG] Evaluation Expression：[SF.isNotEmpty(dept_name)], Result：[true], Parameter：[dept_name:[&#123;s,a,l,e,s&#125;,<span class="number">0</span>]]</span><br><span class="line">[DEBUG] Executed SQL[</span><br><span class="line">SELECT /* department/select_department */</span><br><span class="line">        DEPT.DEPT_NO    AS      DEPT_NO</span><br><span class="line">,       DEPT.DEPT_NAME  AS      DEPT_NAME</span><br><span class="line">FROM</span><br><span class="line">        DEPARTMENT      DEPT</span><br><span class="line">WHERE</span><br><span class="line">        <span class="number">1</span>                               =       <span class="number">1</span></span><br><span class="line">AND     DEPT.DEPT_NO    =       ?/*dept_no*/</span><br><span class="line">AND     DEPT.DEPT_NAME  =       ?/*dept_name*/</span><br><span class="line"></span><br><span class="line">]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">1</span>], Parameter name[dept_no], Value[<span class="number">1001</span>], Class[Integer]]</span><br><span class="line">[DEBUG] <span class="built_in">Set</span> the parameter.[INDEX[<span class="number">2</span>], Parameter name[dept_name], Value[sales], Class[String]]</span><br><span class="line">[DEBUG] Execute search SQL.</span><br><span class="line">[INFO ]</span><br><span class="line">+-------+---------+</span><br><span class="line">|DEPT_NO|DEPT_NAME|</span><br><span class="line">+-------+---------+</span><br><span class="line">|   <span class="number">1001</span>|sales    |</span><br><span class="line">+-------+---------+</span><br><span class="line">[DEBUG] SQL execution <span class="built_in">time</span> [department/select_department] : [<span class="number">00</span>:<span class="number">00</span>:<span class="number">00</span>.<span class="number">001</span>]</span><br><span class="line">query sql[department/select_department] end.</span><br><span class="line">uroborosql &gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>REPLではコード補完を利用することができます。<br>コード補完を使用することで選択できる情報が適宜補完され、ストレスなくREPLの操作を行うことができます。</p>
<p>例えば、以下のコマンドを実行する際、<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uroborosql &gt; query department/select_department dept_no=<span class="number">1001</span> dept_name=sales</span><br></pre></td></tr></table></figure></p>
<p>Tabキーを押下することで、選択可能な候補が表示され、選択肢が特定できる場合はコードが補完されます。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">uroborosql &gt; q</span><br><span class="line">↓ [Tab]を入力</span><br><span class="line">uroborosql &gt; query    // 一意に特定できる場合は補完される</span><br><span class="line">↓　[Space]de[Tab]を入力</span><br><span class="line">department/insert_department  department/select_department    // 選択可能なSQL名候補の表示</span><br><span class="line">uroborosql &gt; query department/    // 特定できるところまでが補完される</span><br><span class="line">↓　s[Tab]を入力</span><br><span class="line">uroborosql &gt; query department/select_department　　　// 一意に特定できたため、SQL名がコード補完される</span><br><span class="line">↓　[Space][Tab]を入力</span><br><span class="line">dept_no     dept_name　// 選択可能なバインドパラメータ候補の表示</span><br><span class="line">↓　dept_no=<span class="number">1001</span>を入力</span><br><span class="line">uroborosql &gt; query department/select_department dept_no=<span class="number">1001</span></span><br><span class="line">↓　[Space][Tab]を入力</span><br><span class="line">uroborosql &gt; query department/select_department dept_no=<span class="number">1001</span> dept_name  　　// すでに選択されたバインドパラメータは選択候補にならず、dept_nameが特定できるため補完される</span><br><span class="line">↓　=salesを入力</span><br><span class="line">uroborosql &gt; query department/select_department dept_no=<span class="number">1001</span> dept_name=sales</span><br></pre></td></tr></table></figure>
<p>REPLを終了する場合はコマンド<code>quit</code>,もしくは<code>exit</code>を入力してください。<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; quit[Enter]</span><br><span class="line">SQL REPL end.</span><br></pre></td></tr></table></figure></p>
<p>終了メッセージが表示されてREPLが終了します。</p>
<p>さて、ここまでREPLの操作を説明してきましたが、DB接続情報やSQLファイルの場所はどこで指定していたのでしょうか。<br>実は<code>jp.co.future.uroborosql.client.SqlREPL</code>を実行する際、引数としてプロパティファイルを指定します。このプロパティファイルにDB接続情報やSQLファイルの場所などREPLを実行するのに必要な情報が記載されています。</p>
<p>pom.xmlのREPL実行部分<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.mojo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>exec-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">id</span>&gt;</span>repl<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>java<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">workingDirectory</span>&gt;</span>$&#123;basedir&#125;<span class="tag">&lt;/<span class="name">workingDirectory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">mainClass</span>&gt;</span>jp.co.future.uroborosql.client.SqlREPL<span class="tag">&lt;/<span class="name">mainClass</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">arguments</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">argument</span>&gt;</span>REPL/repl.properties<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">arguments</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">phase</span>&gt;</span>process-classes<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>初期設定ではプロパティファイルの場所は<code>REPL/repl.properties</code>になっています。<br>REPL/repl.properties<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">db.url=jdbc:h2:file:./target/db/repldb;</span><br><span class="line">db.user=sa</span><br><span class="line">db.password=</span><br><span class="line"></span><br><span class="line">sql.additionalClassPath=$&#123;user.home&#125;/.m2/repository/com/h2database/h2/1.4.192/h2-1.4.192.jar</span><br></pre></td></tr></table></figure></p>
<table>
<thead>
<tr>
<th style="text-align:left">プロパティ名</th>
<th style="text-align:left">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">db.url</td>
<td style="text-align:left">DB接続URL</td>
</tr>
<tr>
<td style="text-align:left">db.userDB接続ユーザ</td>
</tr>
<tr>
<td style="text-align:left">db.password</td>
<td style="text-align:left">DB接続パスワード</td>
</tr>
<tr>
<td style="text-align:left">sql.additionalClassPath</td>
<td style="text-align:left">REPL起動時に起動時クラスパス以外でクラスパスに追加する場所。<code>;</code>で区切ることで複数指定可。SQLファイルのルート（sqlフォルダの親フォルダ）をクラスパスに追加することで、自動的にSQLファイルがロードされます。合わせて接続するDBのJDBCドライバを含むJarを指定することで動的にJDBCドライバを読み込みます。</td>
</tr>
</tbody>
</table>
<p>このプロパティファイルを変更することでいろいろなDBに接続することができるようになります。</p>
<p>これまで見てきたようにREPLを利用することで簡単にSQL実行や動作確認ができるので、SQL開発には欠かせないツールになります。<br>色々なSQLを記述してREPLで試してみてください。</p>
<p>これで <em>Getting Started</em> は終了です。</p>
<p>uroboroSQLで使用するSQLの文法や基本的な操作については<a href="../basics/">基本操作</a>を参照してください。</p>
<div style="font-size:130%; font-weight:bold;"><br>  <a href="../why_uroborosql" style="float:left">&#60;&#60; Why uroboroSQL?</a><a href="../basics" style="float:right">基本操作 &#62;&#62;</a><br></div>


<!-- Tags -->



<div class="tags">
    
</div>



<!-- Comments -->
<div>
    


</div>



            </div>
        </div>

        <!-- Footer -->
<footer id="footer">
  <div class="inner">
      <div>
        <h2>Share</h2>
        <ul class="sns-area">
          <li>
            <a href="https://twitter.com/share" class="twitter-share-button" data-url="https://future-architect.github.io/uroborosql-doc/">Tweet</a>
            <script>
            ! function(d, s, id) {
              var js, fjs = d.getElementsByTagName(s)[0],
                p = /^http:/.test(d.location) ? 'http' : 'https';
              if (!d.getElementById(id)) { js = d.createElement(s);
                js.id = id;
                js.src = p + '://platform.twitter.com/widgets.js';
                fjs.parentNode.insertBefore(js, fjs); } }(document, 'script', 'twitter-wjs');

            </script>
          </li>
          <li>
            <iframe src="https://www.facebook.com/plugins/like.php?href=https%3A%2F%2Ffuture-architect.github.io%2Furoborosql-doc%2F&width=130&layout=button_count&action=like&size=small&show_faces=true&share=true&height=46&appId=316260158574612" width="130" height="46" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowtransparency="true"></iframe>
          </li>
          <li>
            <a href="http://b.hatena.ne.jp/entry/s/future-architect.github.io/uroborosql-doc/" class="hatena-bookmark-button" data-hatena-bookmark-layout="basic-counter" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;"></a>
            <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
          </li>
          <li>
            <div class="g-plusone" data-size="medium" data-href="https://future-architect.github.io/uroborosql-doc/"></div>
          </li>
        </ul>
      </div>
      <div>
          <h2>Follow</h2>
          <ul class="icons">
              
                  <li><a href="https://twitter.com/future_techblog" class="icon style2 fa-twitter" target="_blank"><span class="label">Twitter</span></a></li>
              
              
                  <li><a href="https://www.facebook.com/future.saiyo" class="icon style2 fa-facebook" target="_blank"><span class="label">Facebook</span></a></li>
              
              
                  <li><a href="https://github.com/future-architect" class="icon style2 fa-github" target="_blank"><span class="label">GitHub</span></a></li>
              
              
                  <li><a href="http://qiita.com/organizations/future" class="icon style2 fa-pencil" target="_blank"><span class="label">Qiita</span></a></li>
              
              
                 <li><a href="https://future-architect.github.io/" class="icon style2 fa-pencil-square-o" target="_blank"><span class="label">Tech Blog</span></a></li>
              
          </ul>
      </div>
      <br>
      <ul class="copyright">
          <li>&copy; 2018 - 2019 Future Corporation. All rights reserved</li>
          <li>Design: <a href="http://html5up.net" target="_blank">HTML5 UP</a></li>
      </ul>
  </div>
</footer>
    </div>

    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="/uroborosql-doc/js/jquery.min.js"></script>

<!-- skel -->
<script src="/uroborosql-doc/js/skel.min.js"></script>

<!-- Custom Code -->
<script src="/uroborosql-doc/js/util.js"></script>

<!--[if lte IE 8]>
<script src="/uroborosql-doc/js/ie/respond.min.js"></script>
<![endif]-->

<!-- Custom Code -->
<script src="/uroborosql-doc/js/main.js"></script>

<!-- Gallery -->
<script src="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->


</body>

</html>