(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{50:function(s,a,t){"use strict";t.r(a);var e=t(0),n=Object(e.a)({},function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_2waysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2waysql","aria-hidden":"true"}},[s._v("#")]),s._v(" 2WaySQL")]),s._v(" "),t("p",[t("strong",[s._v("uroboroSQL")]),s._v("の基本操作について説明する前に"),t("strong",[s._v("uroboroSQL")]),s._v("を利用する上で必要になる項目について説明します。")]),s._v(" "),t("h2",{attrs:{id:"_2waysqlとは"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2waysqlとは","aria-hidden":"true"}},[s._v("#")]),s._v(" 2WaySQLとは")]),s._v(" "),t("p",[s._v("2WaySQLは普通のSQL文をファイルに保存したものです。そのままSQLクライアントツールで実行することもできますし、"),t("strong",[s._v("uroboroSQL")]),s._v("で読み込んで実行することも出来ます。"),t("br"),s._v("\n（２つの実行方法があることから"),t("strong",[s._v("2Way")]),s._v("SQLと呼ばれます）")]),s._v(" "),t("h2",{attrs:{id:"バインドパラメータ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#バインドパラメータ","aria-hidden":"true"}},[s._v("#")]),s._v(" バインドパラメータ")]),s._v(" "),t("p",[s._v("SQLにバインドするパラメータを "),t("code",[s._v("/*parameter name*/")]),s._v("の形式で指定することができます。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  department\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n  dept_no    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*dept_no*/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v("  dept_name  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*dept_name*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Sales'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("上の例では、"),t("code",[s._v("/*dept_no*/")]),s._v(", "),t("code",[s._v("/*dept_name*/")]),s._v(" がバインドパラメータで、"),t("strong",[s._v("uroboroSQL")]),s._v("から実行される際はこの部分が"),t("code",[s._v("?")]),s._v("に置き換わり、後ろの"),t("code",[s._v("10")]),s._v("や"),t("code",[s._v("'Sales'")]),s._v("が削除されます。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  department\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n  dept_no    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  ?"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*dept_no*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  dept_name  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  ?"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*dept_name*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"in句の利用方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#in句の利用方法","aria-hidden":"true"}},[s._v("#")]),s._v(" IN句の利用方法")]),s._v(" "),t("p",[s._v("List型の値をIN句のバインドパラメータとして指定することもできます。")]),s._v(" "),t("div",{staticClass:"warning custom-block"},[t("p",[s._v("IN句にバインドパラメータを指定する場合、バインドパラメータの後ろに"),t("code",[s._v("()")]),s._v("を記述する必要があります。")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*IF gender_list != null*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gender  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("in")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*gender_list*/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'M'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("上の例に"),t("code",[s._v("gender_list")]),s._v('として{"M", "F"}を指定すると以下のように変換されます。')]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*IF gender_list != null*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gender  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("in")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("?"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ?"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*gender_list*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"like句の利用方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#like句の利用方法","aria-hidden":"true"}},[s._v("#")]),s._v(" LIKE句の利用方法")]),s._v(" "),t("p",[s._v("LIKE句に対してバインドパラメータを使用する場合は、以下のように"),t("router-link",{attrs:{to:"/background/ognl.html#stringfunction-sf"}},[s._v("StringFunction")]),s._v("を使って記述してください。")],1),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*IF first_name != null*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*SF.contains(first_name)*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("escape")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*IF last_name != null*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("last_name  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*SF.startsWith(last_name)*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("escape")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("上の例で、バインドパラメータ "),t("code",[s._v("first_name")]),s._v("に"),t("code",[s._v("a")]),s._v(", "),t("code",[s._v("last_name")]),s._v("に"),t("code",[s._v("D")]),s._v("を指定した場合は以下のようになります。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n    emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%a%'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("escape")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("last_name  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'D%'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("escape")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("上の例で、ワイルドカードを含む例としてバインドパラメータ "),t("code",[s._v("first_name")]),s._v("に"),t("code",[s._v("a%")]),s._v(", "),t("code",[s._v("last_name")]),s._v("に"),t("code",[s._v("D_")]),s._v("を指定した場合は以下のようになります。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n    emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first_name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%a$%%'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("escape")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- %がエスケープされる")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("last_name  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'D$_%'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("escape")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- _がエスケープされる")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("div",{staticClass:"tip custom-block"},[t("p",[s._v("ワイルドカード（"),t("code",[s._v("%")]),s._v("や"),t("code",[s._v("_")]),s._v("）を含む文字列がバインドパラメータに指定された場合でも、"),t("router-link",{attrs:{to:"/background/ognl.html#stringfunction-sf"}},[s._v("StringFunction")]),s._v("を利用することで文字列のエスケープ処理が適切に行われます。")],1)]),s._v(" "),t("div",{staticClass:"warning custom-block"},[t("p",[s._v("エスケープキャラクタ（上記の例では"),t("code",[s._v("$")]),s._v("）はDB毎の設定（"),t("router-link",{attrs:{to:"/configuration/dialect.html#dialect"}},[s._v("Dialect")]),s._v("）によって変わります。"),t("br"),s._v("\n現在の設定では、Oracleの場合は"),t("code",[s._v("\\")]),s._v(", その他のDBでは"),t("code",[s._v("$")]),s._v("となります。")],1)]),s._v(" "),t("h2",{attrs:{id:"バインド出来るパラメータの型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#バインド出来るパラメータの型","aria-hidden":"true"}},[s._v("#")]),s._v(" バインド出来るパラメータの型")]),s._v(" "),t("p",[s._v("バインドパラメータに指定できるJava型は以下になります。")]),s._v(" "),t("ul",[t("li",[s._v("プリミティブ型とそのラッパー型（ただし char と java.lang.Character は除く）")]),s._v(" "),t("li",[s._v("java.math.BigDecimal")]),s._v(" "),t("li",[s._v("java.math.BigInteger")]),s._v(" "),t("li",[s._v("java.lang.String")]),s._v(" "),t("li",[s._v("byte[]")]),s._v(" "),t("li",[s._v("java.sql.Date")]),s._v(" "),t("li",[s._v("java.sql.Time")]),s._v(" "),t("li",[s._v("java.sql.Timestamp")]),s._v(" "),t("li",[s._v("java.sql.Array")]),s._v(" "),t("li",[s._v("java.sql.Ref")]),s._v(" "),t("li",[s._v("java.sql.Blob")]),s._v(" "),t("li",[s._v("java.sql.Clob")]),s._v(" "),t("li",[s._v("java.sql.SQLXML")]),s._v(" "),t("li",[s._v("java.sql.Struct")]),s._v(" "),t("li",[s._v("列挙型(enum)")]),s._v(" "),t("li",[s._v("java.util.Date")]),s._v(" "),t("li",[s._v("java.util.Optional")]),s._v(" "),t("li",[s._v("java.util.OptionalInt")]),s._v(" "),t("li",[s._v("java.util.OptionalLong")]),s._v(" "),t("li",[s._v("java.util.OptionalDouble")]),s._v(" "),t("li",[s._v("java.time.LocalDateTime")]),s._v(" "),t("li",[s._v("java.time.OffsetDateTime")]),s._v(" "),t("li",[s._v("java.time.ZonedDateTime")]),s._v(" "),t("li",[s._v("java.time.LocalDate")]),s._v(" "),t("li",[s._v("java.time.LocalTime")]),s._v(" "),t("li",[s._v("java.time.OffsetTime")]),s._v(" "),t("li",[s._v("java.time.Year")]),s._v(" "),t("li",[s._v("java.time.YearMonth")]),s._v(" "),t("li",[s._v("java.time.MonthDay")]),s._v(" "),t("li",[s._v("java.time.Month")]),s._v(" "),t("li",[s._v("java.time.DayOfWeek")])]),s._v(" "),t("h2",{attrs:{id:"置換文字列"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#置換文字列","aria-hidden":"true"}},[s._v("#")]),s._v(" 置換文字列")]),s._v(" "),t("p",[s._v("置換文字列を使うとSQLを動的に変更することができます。")]),s._v(" "),t("p",[s._v("置換文字列は "),t("code",[s._v("/*$parameter name*/")]),s._v(" もしくは "),t("code",[s._v("/*#parameter name*/")]),s._v("と記述します。"),t("br"),s._v(" "),t("code",[s._v("/*#parameter name*/")]),s._v(" と記述した場合は、置換文字列の前後を"),t("code",[s._v("'")]),s._v("(シングルクォート)で囲みます。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*$table_name*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n  gender  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*#gender*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("上の例では、"),t("code",[s._v("table_name")]),s._v("や"),t("code",[s._v("gender")]),s._v("に設定した値でSQLが置換されます。")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("table_name")]),s._v("に"),t("code",[s._v("employee")]),s._v(", "),t("code",[s._v("gender")]),s._v("に"),t("code",[s._v("M")]),s._v("を設定した場合")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("  employee\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n  gender  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'M'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("という風に置換されたSQLが実行されることになります。")]),s._v(" "),t("div",{staticClass:"danger custom-block"},[t("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),t("p",[s._v("置換文字列はSQLインジェクションなど脆弱性の原因となる可能性があります。十分に注意を払ったうえで利用してください")])]),s._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",[s._v("置換文字列はSQLインジェクションを防ぐため、変換の際にシングルクォート"),t("code",[s._v("'")]),s._v("を"),t("code",[s._v("''")]),s._v("にエスケープします")])]),s._v(" "),t("div",{staticClass:"warning custom-block"},[t("p",[s._v("置換文字列はバインドパラメータとしてではなく実行されるSQLを構築する時点で置換される点に注意してください。"),t("br"),s._v("\nデータベースによってはSQL文が動的に変わることで解析結果のキャッシュが適用されず、"),t("br"),s._v("\n解析処理が都度実行されることでCPUに負荷をかける可能性があります。")])]),s._v(" "),t("h2",{attrs:{id:"条件分岐"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#条件分岐","aria-hidden":"true"}},[s._v("#")]),s._v(" 条件分岐")]),s._v(" "),t("p",[t("code",[s._v("/*IF*/")]),s._v(", "),t("code",[s._v("/*ELIF*/")]),s._v(", "),t("code",[s._v("/*ELSE*/")]),s._v(", "),t("code",[s._v("/*END*/")]),s._v(" を使用してSQLを動的に変更することができます。")]),s._v(" "),t("h3",{attrs:{id:"記述方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#記述方法","aria-hidden":"true"}},[s._v("#")]),s._v(" 記述方法")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*IF [評価式]*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- IFの評価式が真の場合に適用されるSQL")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*ELIF [評価式]*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- ELIFの評価式が真の場合に適用されるSQL")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*ELSE*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- IF,ELIFの評価式が偽の場合に適用されるSQL")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[t("code",[s._v("/*IF*/")]),s._v(", "),t("code",[s._v("/*ELIF*/")]),s._v("の評価式としてOGNL式言語を利用します。\n（ OGNL式言語の説明は"),t("router-link",{attrs:{to:"/background/ognl.html#ognl式言語"}},[s._v("こちら")]),s._v(" )"),t("br"),s._v("\nまた、標準でSF関数("),t("em",[s._v("S")]),s._v("tring "),t("em",[s._v("F")]),s._v("unction)を使うことができます。")],1),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*IF SF.isNotEmpty(birth_date_from) and SF.isNotEmpty(birth_date_to)*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("birth_date  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("between")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*birth_date_from*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1990-01-01'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*birth_date_to*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1999-12-31'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*ELIF SF.isNotEmpty(birth_date_from)*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("birth_date  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*birth_date_from*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1990-01-01'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*ELIF SF.isNotEmpty(birth_date_to)*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("birth_date  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*birth_date_to*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1999-12-31'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*ELSE*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[s._v("上の例ではIFの評価式として"),t("code",[s._v("SF.isNotEmpty()")]),s._v("を使用してバインドパラメータが"),t("code",[s._v("null")]),s._v("または"),t("code",[s._v('""')]),s._v("でないことを評価しています。")]),s._v(" "),t("p",[s._v("バインドパラメータとして"),t("code",[s._v("birth_date_from")]),s._v("に"),t("code",[s._v("2000-01-01")]),s._v(", "),t("code",[s._v("birth_date_to")]),s._v("に"),t("code",[s._v("2010-12-31")]),s._v("を指定した場合、生成されるSQLは以下のようになります。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("birth_date  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("between")]),s._v("  ?"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*birth_date_from*/")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  ?"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*birth_date_to*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("最後にバインドパラメータが評価され、実行されるSQLが以下になります。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("birth_date  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("between")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2000-01-01'")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*birth_date_from*/")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2010-12-31'")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*birth_date_to*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("ここで"),t("code",[s._v("emp.birth_date")]),s._v("の前にあった"),t("code",[s._v("and")]),s._v("が消えていることに注目してください。")]),s._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",[t("strong",[s._v("uroboroSQL")]),s._v("では動的SQLを生成する際、WHERE句の後ろに"),t("code",[s._v("and")]),s._v("や"),t("code",[s._v("or")]),s._v("が来る場合はそれを削除してSQL文として正しい状態にします")])]),s._v(" "),t("p",[s._v("ただし、上の加工前SQLのようにSQL文として不正な状態になってしまうのでSQLクライアントツールからは実行できないという欠点もあります。"),t("br"),s._v("\nこのようにSQL文として不正になることを防ぐために、WHERE句のあとに他に影響を与えない評価を入れる方法があります。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// <-- 必ずtrueとなる評価を入れる")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*IF SF.isNotEmpty(birth_date_from) and SF.isNotEmpty(birth_date_to)*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("birth_date  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("between")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*birth_date_from*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1990-01-01'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*birth_date_to*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1999-12-31'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*ELIF SF.isNotEmpty(birth_date_from)*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("birth_date  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*birth_date_from*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1990-01-01'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*ELIF SF.isNotEmpty(birth_date_to)*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("birth_date  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*birth_date_to*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1999-12-31'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*ELSE*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h2",{attrs:{id:"範囲の有効化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#範囲の有効化","aria-hidden":"true"}},[s._v("#")]),s._v(" 範囲の有効化")]),s._v(" "),t("p",[t("code",[s._v("/*BEGIN*/")]),s._v(", "),t("code",[s._v("/*END*/")]),s._v(" で囲まれた範囲は、その中の"),t("code",[s._v("/*IF*/")]),s._v(", "),t("code",[s._v("/*ELIF*/")]),s._v("のうち、どれか1つでも真(true)になった場合に出力されます。"),t("br"),s._v("\n範囲内の全ての評価式が偽（false）の場合、"),t("code",[s._v("/*BEGIN*/")]),s._v(", "),t("code",[s._v("/*END*/")]),s._v(" で囲まれた範囲は出力されません。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*BEGIN*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*IF SF.isNotEmpty(first_name)*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first_name  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*first_name*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Bob'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*IF SF.isNotEmpty(last_name)*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v("  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("last_name  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*last_name*/")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Smith'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[s._v("上の例で、バインドパラメータ "),t("code",[s._v("first_name")]),s._v("に"),t("code",[s._v("Willson")]),s._v(", "),t("code",[s._v("last_name")]),s._v("に"),t("code",[s._v("null")]),s._v("を指定した場合は以下のようになります。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v("\n  emp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first_name  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  ?"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*first_name*/")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("バインドパラメータ "),t("code",[s._v("first_name")]),s._v(", "),t("code",[s._v("last_name")]),s._v("ともに"),t("code",[s._v("null")]),s._v("を指定した場合は以下のようになります。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("code",[s._v("/*BEGIN*/")]),s._v(","),t("code",[s._v("/*END*/")]),s._v("で囲まれた"),t("code",[s._v("where")]),s._v("が出力されていないことがわかります。")]),s._v(" "),t("h2",{attrs:{id:"不要なカンマの除去"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#不要なカンマの除去","aria-hidden":"true"}},[s._v("#")]),s._v(" 不要なカンマの除去")]),s._v(" "),t("p",[s._v("IF分岐を使って動的なSQLを構築する場合、カンマの有無が問題になる場合があります。"),t("br"),s._v("\n以下のSQLを例として説明します。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*IF detail*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  first_name\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  last_name\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  birth_date\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  gender\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  emp_no\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*IF detail*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  birth_date\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/*END*/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  emp_no\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("ここでバインドパラメータ"),t("code",[s._v("detail")]),s._v("に"),t("code",[s._v("true")]),s._v("を指定した場合、生成されるSQLは以下になります。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  first_name\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  last_name\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  birth_date\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  gender\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  emp_no\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  birth_date\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  emp_no\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("このSQLでは"),t("code",[s._v("select")]),s._v("の直後や"),t("code",[s._v("order by")]),s._v("の直後にカンマが出現しておりSQL文として不正であるため、SQLの実行に失敗します。"),t("br"),s._v("\nこれを避けるため"),t("strong",[s._v("uroboroSQL")]),s._v("では、生成後のSQLに含まれる不要なカンマを除去するようになっています。")]),s._v(" "),t("p",[s._v("実際に生成されるSQLは以下になります。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v("\n  first_name     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 先頭のカンマが除去される")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  last_name\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  birth_date\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  gender\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  emp_no\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("\n  employee  emp\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v("\n  birth_date     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 先頭のカンマが除去される")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  emp_no\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("カンマが除去されるのは、以下の予約語の直後にカンマが出現した場合です（大文字小文字の区別無し）。")]),s._v(" "),t("ul",[t("li",[s._v("SELECT")]),s._v(" "),t("li",[s._v("ORDER BY")]),s._v(" "),t("li",[s._v("GROUP BY")]),s._v(" "),t("li",[s._v("(")]),s._v(" "),t("li",[s._v("SET")])])])},[],!1,null,null,null);a.default=n.exports}}]);